/*!CK:3385783858!*//*1375709741,173209645*/

if (self.CavalryLogger) { CavalryLogger.start_js(["Y2kpX"]); }

__d("ChatHovercard",["Arbiter","AsyncLoader","Hovercard","JSLogger","debounce"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncLoader'),i=b('Hovercard'),j=b('JSLogger'),k=b('debounce'),l=5,m=new h('/ajax/chat/hovercard/sidebar.php','hover'),n=j.create('chat_hovercard');g.subscribe('Hovercard/dirty',m.reset.bind(m));function o(s,t){m.get(s,function(u){(function(){if(!u){n.error('fetch_failure',{id:s});return;}var v=i.getDialog(u);if(!v){n.error('no_hovercard',{id:s,endpoint:u});return;}if(s==t.getActiveID())t.showHovercard(s,v);}).defer();});}function p(s,t){var u=[];function v(y){if(y>=0&&y<s.length)u.push(s[y]);}var w=s.indexOf(t);if(w>-1){v(w);for(var x=1;x<l;x++){v(w+x);v(w-x);}}return u.filter(function(y){return y;});}function q(s,t){var u=t.getActiveID();if(u){var v=s.getShowingUsers(),w=p(v,u);m.get(w,function(){});}}function r(s){var t=s.getHoverController();t.registerDefault(o);t.subscribe('hover',k(q.curry(s,t),100));}e.exports=r;});
__d("ChatOrderedListHover",["function-extensions","ArbiterMixin","ChatFavoriteList","CSS","ErrorUtils","Event","LayerHideOnBlur","Parent","copyProperties","cx","setTimeoutAcrossTransitions","shield"],function(a,b,c,d,e,f){b('function-extensions');var g=b('ArbiterMixin'),h=b('ChatFavoriteList'),i=b('CSS'),j=b('ErrorUtils'),k=b('Event'),l=b('LayerHideOnBlur'),m=b('Parent'),n=b('copyProperties'),o=b('cx'),p=b('setTimeoutAcrossTransitions'),q=b('shield');function r(u){i.addClass(u,'fetching');}function s(u){i.removeClass(u,'fetching');}function t(u){this._orderedList=u;this._root=u.getRoot();k.listen(this._root,'mouseover',this._mouseOver.bind(this));k.listen(this._root,'mouseleave',this._mouseLeave.bind(this));u.subscribe('click',q(this._hide,this));}n(t.prototype,g,{_root:null,_activeItem:null,_hideTimeout:null,_showTimeout:null,_showingDialog:null,_showingID:null,_handlers:{},_defaultHandler:null,_mouseOver:function(event){if(this._paused)return;var u=event.getTarget(),v=m.byClass(u,"_42fz")||m.byClass(u,"_5a58");v&&this._setActiveItem(v);},_mouseLeave:function(event){this._setActiveItem(null);},_clearTimeouts:function(){this._showTimeout&&clearTimeout(this._showTimeout);this._showTimeout=null;this._hideTimeout&&clearTimeout(this._hideTimeout);this._hideTimeout=null;},_hide:function(){if(this._showingDialog){this._showingDialog.hide();this._showingDialog=null;this._showingID=null;}},_show:function(){var u=this.getActiveID(),v=false;if(this._handlers[u]){v=true;j.applyWithGuard(this._handlers[u],{},[u,this]);}else if(this._defaultHandler){v=true;j.applyWithGuard(this._defaultHandler,{},[u,this]);}if(v&&this._showingID!=this.getActiveID())r(this._activeItem);},_setActiveItem:function(u){if(h.isEditMode()){this._clearTimeouts();this._hide();return;}if(u!=this._activeItem){this._clearTimeouts();this._activeItem&&s(this._activeItem);this._activeItem=null;var v=u?0:100;this._hideTimeout=p(function(){if(this.getActiveID()!=this._showingID)this._hide();}.bind(this),v);if(u){this._activeItem=u;var w=v+500;this._showTimeout=p(function(){this._show();}.bind(this),w);this.inform('hover');}else this.inform('leave');}},register:function(u,v){if(!this._handlers[u]){this._handlers[u]=v;return {unregister:function(){if(u==this._showingID)this._hide();delete this._handlers[u];var w=this._orderedList.getAllNodes(),x=w[u];x&&s(x);}.bind(this)};}},registerDefault:function(u){this._defaultHandler=u;},getActiveID:function(){var u=this._activeItem&&this._orderedList.getUserForNode(this._activeItem);return u||null;},showHovercard:function(u,v){if(u==this.getActiveID()&&u!=this._showingID){this._clearTimeouts();s(this._activeItem);this._hide();this._showingDialog=v;this._showingID=u;var w=v.subscribe('mouseenter',this._setActiveItem.bind(this,this._activeItem)),x=v.subscribe('mouseleave',function(){w.unsubscribe();this._setActiveItem(null);}.bind(this)),y=v.subscribe('hide',function(){this.inform('hovercard_hide');w.unsubscribe();x.unsubscribe();y.unsubscribe();}.bind(this));v.enableBehavior(l).setContext(this._activeItem).setPosition('left').show();this.inform('hovercard_show');}},setPaused:function(u){this._paused=u;}});e.exports=t;});
__d("ChatQuietLinks",["Event","DOM","UserAgent","DataStore","Parent"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('UserAgent'),j=b('DataStore'),k=b('Parent'),l={},m={silenceLinks:function(q){n(q,this.removeEmptyHrefs.bind(this));},nukeLinks:function(q){n(q,this.removeAllHrefs.bind(this));},removeEmptyHrefs:function(q){o(q,function(r){return !r||r==='#';});},removeAllHrefs:function(q){o(q);},removeMessagesHrefs:function(q){o(q,function(r){return !r||r==='#'||r.indexOf('/messages/')!=-1;});}};function n(q,r){var s=!!i.chrome(),t=!!i.chrome()||i.ie()>=9||i.firefox()>=4;if(l[h.getID(q)])return;l[h.getID(q)]=true;if(!t)return;if(!s){r&&r(q);return;}g.listen(q,'mouseover',function u(v){var w=k.byTag(v.getTarget(),'a');if(w){var x=w.getAttribute('href');if(p(x)){j.set(w,'stashedHref',w.getAttribute('href'));w.removeAttribute('href');}}});g.listen(q,'mouseout',function u(v){var w=k.byTag(v.getTarget(),'a'),x=w&&j.remove(w,'stashedHref');if(p(x))w.setAttribute('href',x);});g.listen(q,'mousedown',function(u){if(!u.isDefaultRequested())return true;var v=k.byTag(u.getTarget(),'a'),w=v&&j.get(v,'stashedHref');if(p(w))v.setAttribute('href',w);});}function o(q,r){var s=h.scry(q,'a');if(r)s=s.filter(function(t){return r(t.getAttribute('href'));});s.forEach(function(t){t.removeAttribute('href');t.setAttribute('tabindex',0);});}function p(q){return q&&q!=='#';}e.exports=m;});
__d("AbstractButton.react",["Link.react","ReactPropTypes","React","cx","invariant"],function(a,b,c,d,e,f){var g=b('Link.react'),h=b('ReactPropTypes'),i=b('React'),j=b('cx'),k=b('invariant');function l(n,o){if(n.props.className){n.props.className+=' '+o;}else n.props.className=o;}var m=i.createClass({displayName:'AbstractButton',propTypes:{image:function(n,o,p){var q=n[o];k(q==null||i.isValidComponent(q));return q;},depressed:h.bool,imageOnRight:h.bool,href:h.object},render:function(){var n=(("_42ft")+(this.props.disabled?' '+"_42fr":'')+(this.props.depressed?' '+"_42fs":'')),o=this.props.image,p=this.props.label;if(o&&p)if(this.props.imageOnRight){l(o,'mls');}else l(o,'mrs');var q;if(this.props.href){q=g({disabled:null});}else{var r=this.props.type||'submit';q=i.DOM.button({type:r});if(r==='submit')q.props.value='1';}if(this.props.imageOnRight){q.props.children=[p,o];}else q.props.children=[o,p];q.props.className=n;q.props.label=null;return this.transferPropsTo(q);}});e.exports=m;});
__d("XUIButton.react",["AbstractButton.react","ReactPropTypes","React","cx"],function(a,b,c,d,e,f){var g=b('AbstractButton.react'),h=b('ReactPropTypes'),i=b('React'),j=b('cx'),k='medium',l=i.createClass({displayName:'XUIButton',propTypes:{use:h.oneOf(['default','special','confirm']),size:h.oneOf(['small','medium','large','xlarge','xxlarge']),suppressed:h.bool},getDefaultProps:function(){return {use:'default',size:k,suppressed:false};},getButtonSize:function(){return this.props.size||k;},render:function(){var m=this.props.use,n=this.getButtonSize(),o=this.props.suppressed,p=(("_4jy0")+(n==='small'?' '+"_517i":'')+(n==='medium'?' '+"_4jy3":'')+(n==='large'?' '+"_4jy4":'')+(n==='xlarge'?' '+"_4jy5":'')+(n==='xxlarge'?' '+"_4jy6":'')+(m==='default'?' '+"_517h":'')+(m==='confirm'?' '+"_4jy1":'')+(m==='special'?' '+"_4jy2":'')+(o?' '+"_59pe":'')+(m==='confirm'||m==='special'?' '+"selected":''));return this.transferPropsTo(g({className:p}));}});e.exports=l;});
__d("FeatureDetection",["UserAgent"],function(a,b,c,d,e,f){var g=b('UserAgent');e.exports={isFileAPISupported:function(){if(g.webkit()&&!g.chrome()&&g.windows())return false;return ('FileList' in window)&&('FormData' in window);},isBlobFactorySupported:function(){return !!a.Blob;}};});
__d("AsyncUploadBase",["ArbiterMixin","AsyncRequest","AsyncResponse","FeatureDetection","Form","copyProperties","mixin","removeFromArray"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('AsyncRequest'),i=b('AsyncResponse'),j=b('FeatureDetection'),k=b('Form'),l=b('copyProperties'),m=b('mixin'),n=b('removeFromArray'),o=m(g);for(var p in o)if(o.hasOwnProperty(p)&&p!=="_metaprototype")r[p]=o[p];var q=o===null?null:o.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=o;function r(t){this.setURI(t);}r.prototype.setAllowCrossOrigin=function(t){this._allowCrossOrigin=!!t;return this;};r.prototype.setData=function(t){this._data=t;return this;};r.prototype.setLimit=function(t){this._limit=t;return this;};r.prototype.setRelativeTo=function(t){this._relativeTo=t;return this;};r.prototype.setStatusElement=function(t){this._statusElement=t;return this;};r.prototype.setURI=function(t){this._uri=t;return this;};r.prototype.suspend=function(){this._suspended=true;return this;};r.prototype.resume=function(){this._suspended=false;this._processQueue();return this;};r.prototype.isUploading=function(){return this._inFlight;};r.prototype._createFileUpload=function(t,u,v){return new s(t,u,v);};r.prototype._parseFiles=function(t){var u={};for(var v in t){var w=t[v];if(Array.isArray(w)){u[v]=w;}else{u[v]=[];if(w instanceof window.FileList){for(var x=0;x<w.length;x++)u[v].push(w.item(x));}else if(w instanceof window.File||w instanceof window.Blob)u[v].push(w);}}return u;};r.prototype._processQueue=function(){if(this._suspended)return;while(this._pending.length<this._limit){if(!this._waiting.length)break;var t=this._waiting.shift();this._processUpload(t);this._pending.push(t);}};r.prototype._processUpload=function(t){var u=k.createFormData(t.getData()||this._data);if(t.getFile()){u.append(t.getName(),t.getFile());u.append('upload_id',t.getFile().uploadID);}var v=new h().setAllowCrossOrigin(this._allowCrossOrigin).setURI(this._uri).setRawData(u).setRelativeTo(this._relativeTo).setStatusElement(this._statusElement).setHandler(this._success.bind(this,t)).setErrorHandler(this._failure.bind(this,t)).setUploadProgressHandler(this._progress.bind(this,t)).setInitialHandler(this._initial.bind(this,t));v.send();t.setAsyncRequest(v);this._inFlight=true;this.inform('start',t);};r.prototype._abort=function(t){n(this._waiting,t);t.abort();};r.prototype._initial=function(t){this.inform('initial',t);};r.prototype._success=function(t,u){this._complete(t);this.inform('success',t.handleSuccess(u));this._processQueue();};r.prototype._failure=function(t,u){this._complete(t);if(this.inform('failure',t.handleFailure(u))!==false)i.defaultErrorHandler(u);this._processQueue();};r.prototype._progress=function(t,event){this.inform('progress',t.handleProgress(event));};r.prototype._complete=function(t){n(this._pending,t);if(!this._pending.length)this._inFlight=false;};r.isSupported=function(){return j.isFileAPISupported();};l(r.prototype,{_limit:10});function s(t,u,v){this._name=t;this._file=u;this._data=v;this._success=null;this._response=null;this._progressEvent=null;this._request=null;}s.prototype.getName=function(){return this._name;};s.prototype.getFile=function(){return this._file;};s.prototype.getData=function(){return this._data;};s.prototype.isComplete=function(){return this._success!==null;};s.prototype.isSuccess=function(){return this._success===true;};s.prototype.getResponse=function(){return this._response;};s.prototype.getProgressEvent=function(){return this._progressEvent;};s.prototype.setAsyncRequest=function(t){this._request=t;return this;};s.prototype.isWaiting=function(){return !this._request;};s.prototype.abort=function(){this._request&&this._request.abort();this._request=null;};s.prototype.handleSuccess=function(t){this._success=true;this._response=t;this._progressEvent=null;return this;};s.prototype.handleFailure=function(t){this._success=false;this._response=t;this._progressEvent=null;return this;};s.prototype.handleProgress=function(event){this._progressEvent=event;return this;};e.exports=r;});
__d("AsyncUploadRequest",["AsyncUploadBase"],function(a,b,c,d,e,f){var g=b('AsyncUploadBase');for(var h in g)if(g.hasOwnProperty(h)&&h!=="_metaprototype")j[h]=g[h];var i=g===null?null:g.prototype;j.prototype=Object.create(i);j.prototype.constructor=j;j.__superConstructor__=g;function j(){if(g!==null)g.apply(this,arguments);}j.prototype.setFiles=function(k){this._files=this._parseFiles(k);return this;};j.prototype.send=function(){if(this._inFlight)return;this._inFlight=true;this._uploads=[];for(var k in this._files)this._files[k].forEach(function(l){this._uploads.push(this._createFileUpload(k,l));}.bind(this));if(this._uploads.length){this._waiting=this._uploads.slice(0);this._pending=[];this._processQueue();}else this._processUpload(this._createFileUpload(null,null));};j.prototype._processQueue=function(){i._processQueue.call(this);if(!this._pending.length&&!this._waiting.length)this.inform('complete',this._uploads);};j.isSupported=function(){return g.isSupported();};e.exports=j;});
__d("CacheStorage",[],function(a,b,c,d,e,f){var g={memory:j,localstorage:h,sessionstorage:i};function h(){this._store=a.localStorage;}h.prototype.keys=function(){var l=[];for(var m=0;m<this._store.length;m++)l.push(this._store.key(m));return l;};h.prototype.get=function(l){return this._store.getItem(l);};h.prototype.set=function(l,m){this._store.setItem(l,m);};h.prototype.remove=function(l){this._store.removeItem(l);};h.prototype.clear=function(){this._store.clear();};h.available=function(){try{return !!a.localStorage;}catch(l){return false;}};function i(){this._store=a.sessionStorage;}i.prototype.keys=function(){var l=[];for(var m=0;m<this._store.length;m++)l.push(this._store.key(m));return l;};i.prototype.get=function(l){return this._store.getItem(l);};i.prototype.set=function(l,m){this._store.setItem(l,m);};i.prototype.remove=function(l){this._store.removeItem(l);};i.prototype.clear=function(){this._store.clear();};i.available=function(){try{return !!a.sessionStorage;}catch(l){return false;}};function j(){this._store={};}j.prototype.keys=function(){return Object.keys(this._store);};j.prototype.get=function(l){if(this._store[l]===undefined)return null;return this._store[l];};j.prototype.set=function(l,m){this._store[l]=m;};j.prototype.remove=function(l){if(l in this._store)delete this._store[l];};j.prototype.clear=function(){this._store={};};j.available=function(){return true;};function k(l,m){this._key_prefix=m||'_cs_';this._magic_prefix='_@_';if(l=='AUTO'||!l)for(var n in g){var o=g[n];if(o.available()){l=n;break;}}if(l)if(typeof l=='string'){if(!g[l]||!g[l].available()){this._backend=new j();}else this._backend=new g[l]();}else if(!l.available||!l.available()){this._backend=new j();}else this._backend=l;}k.prototype.keys=function(){var l=[];try{if(this._backend){var n=this._backend.keys();for(var o=0;o<n.length;o++)if(n[o].substr(0,this._key_prefix.length)==this._key_prefix)l.push(n[o].substr(this._key_prefix.length));}}catch(m){}return l;};k.prototype.set=function(l,m){if(this._backend){if(typeof m=='string'){m=this._magic_prefix+m;}else m=JSON.stringify(m);try{this._backend.set(this._key_prefix+l,m);}catch(n){}}};k.prototype.get=function(l,m){var n;if(this._backend){try{n=this._backend.get(this._key_prefix+l);}catch(o){n=null;}if(n!==null){if(n.substr(0,this._magic_prefix.length)==this._magic_prefix){n=n.substr(this._magic_prefix.length);}else try{n=JSON.parse(n);}catch(p){n=undefined;}}else n=undefined;}if(n===undefined&&m!==undefined){n=m;if(this._backend){var q;if(typeof n=='string'){q=this._magic_prefix+n;}else q=JSON.stringify(n);try{this._backend.set(this._key_prefix+l,q);}catch(o){}}}return n;};k.prototype.remove=function(l){if(this._backend)try{this._backend.remove(this._key_prefix+l);}catch(m){}};k.getAllStorageTypes=function(){return Object.keys(g);};e.exports=k;});
__d("DOMWrapper",[],function(a,b,c,d,e,f){var g,h,i={setRoot:function(j){g=j;},getRoot:function(){return g||document.body;},setWindow:function(j){h=j;},getWindow:function(){return h||self;}};e.exports=i;});
__d("Flash",["DOMWrapper","QueryString","UserAgent","copyProperties","guid"],function(a,b,c,d,e,f){var g=b('DOMWrapper'),h=b('QueryString'),i=b('UserAgent'),j=b('copyProperties'),k=b('guid'),l={},m,n=g.getWindow().document;function o(t){var u=n.getElementById(t);if(u)u.parentNode.removeChild(u);delete l[t];}function p(){for(var t in l)if(l.hasOwnProperty(t))o(t);}function q(t){return t.replace(/\d+/g,function(u){return '000'.substring(u.length)+u;});}function r(t){if(!m){if(i.ie()>=9)window.attachEvent('onunload',p);m=true;}l[t]=t;}var s={embed:function(t,u,v,w){var x=k();t=encodeURI(t);v=j({allowscriptaccess:'always',flashvars:w,movie:t},v||{});if(typeof v.flashvars=='object')v.flashvars=h.encode(v.flashvars);var y=[];for(var z in v)if(v.hasOwnProperty(z)&&v[z])y.push('<param name="'+encodeURI(z)+'" value="'+encodeURI(v[z])+'">');var aa=n.createElement('div'),ba='<object '+(i.ie()?'classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" ':'type="application/x-shockwave-flash"')+'data="'+t+'" '+'id="'+x+'">'+y.join('')+'</object>';aa.innerHTML=ba;var ca=u.appendChild(aa.firstChild);r(x);return ca;},remove:o,getVersion:function(){var t='Shockwave Flash',u='application/x-shockwave-flash',v='ShockwaveFlash.ShockwaveFlash',w;if(navigator.plugins&&typeof navigator.plugins[t]=='object'){var x=navigator.plugins[t].description;if(x&&navigator.mimeTypes&&navigator.mimeTypes[u]&&navigator.mimeTypes[u].enabledPlugin)w=x.match(/\d+/g);}if(!w)try{w=(new ActiveXObject(v)).GetVariable('$version').match(/(\d+),(\d+),(\d+),(\d+)/);w=Array.prototype.slice.call(w,1);}catch(y){}return w;},checkMinVersion:function(t){var u=s.getVersion();if(!u)return false;return q(u.join('.'))>=q(t);},isAvailable:function(){return !!s.getVersion();}};e.exports=s;});
__d("TextMetrics",["Event","DOM","Style","UserAgent","debounce"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('Style'),j=b('UserAgent'),k=b('debounce'),l;function m(){if(typeof l==='undefined'){var p=h.create('div',{className:'webkitZoomTest'}),q=function(){h.appendContent(document.body,p);l=100/p.clientHeight;h.remove(p);};g.listen(window,'resize',k(q,100));q();}return l;}function n(p){var q=p.clientWidth,r=(i.get(p,'-moz-box-sizing')=='border-box');if(r)return q;var s=i.getFloat(p,'paddingLeft')+i.getFloat(p,'paddingRight');return q-s;}function o(p,q){this._node=p;this._flexible=!!q;var r='textarea',s='textMetrics';if(this._flexible){r='div';s+=' textMetricsInline';}this._shadow=h.create(r,{className:s});var t=['fontSize','fontStyle','fontWeight','fontFamily','wordWrap'];t.forEach(function(v){i.set(this._shadow,v,i.get(p,v));}.bind(this));var u=i.get(p,'lineHeight');if(j.chrome()||j.webkit())u=Math.round(parseInt(u,10)*m())+'px';i.set(this._shadow,'lineHeight',u);document.body.appendChild(this._shadow);}o.prototype.measure=function(p){var q=this._node,r=this._shadow;p=(p||q.value)+'...';if(!this._flexible){var s=n(q);i.set(r,'width',Math.max(s,0)+'px');}h.setContent(r,p);return {width:r.scrollWidth,height:r.scrollHeight};};o.prototype.destroy=function(){h.remove(this._shadow);};e.exports=o;});
__d("Token",["CSS","DataStore","DOM","tx"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DataStore'),i=b('DOM'),j=b('tx');function k(l,m){this.info=l;this.paramName=m;}k.prototype.getInfo=function(){return this.info;};k.prototype.getText=function(){return this.info.text;};k.prototype.getValue=function(){return this.info.uid;};k.prototype.isFreeform=function(){return !!this.info.freeform;};k.prototype.setSelected=function(l){g.conditionClass(this.getElement(),'uiTokenSelected',l);return this;};k.prototype.getElement=function(){if(!this.element)this.setElement(this.createElement());return this.element;};k.prototype.setElement=function(l){h.set(l,'Token',this);this.element=l;return this;};k.prototype.isRemovable=function(){return g.hasClass(this.element,'removable');};k.prototype.createElement=function(l,m){var n=this.paramName,o=this.getText(),p=this.getValue(),q=i.create('a',{href:'#','aria-label':j._("Remove {item}",{item:o}),className:'remove uiCloseButton uiCloseButtonSmall'});if(l)g.addClass(q,'uiCloseButtonSmallGray');var r=i.create('input',{type:'hidden',value:p,name:n+'[]',autocomplete:'off'}),s=i.create('input',{type:'hidden',value:o,name:'text_'+n+'[]',autocomplete:'off'}),t=i.create('span',{className:'removable uiToken'},[o,r,s,q]);if(l)g.addClass(t,'uiTokenGray');if(m){var u=i.create('i',{className:m});i.prependContent(t,u);}return t;};e.exports=k;});
__d("WeakToken",["CSS","Token"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('Token');for(var i in h)if(h.hasOwnProperty(i)&&i!=="_metaprototype")k[i]=h[i];var j=h===null?null:h.prototype;k.prototype=Object.create(j);k.prototype.constructor=k;k.__superConstructor__=h;function k(){if(h!==null)h.apply(this,arguments);}k.prototype.createElement=function(){var l=j.createElement.call(this,true,'UFIWeakReferenceIcon');g.addClass(l,'uiTokenWeakReference');return l;};e.exports=k;});
__d("Tokenizer",["Arbiter","ArbiterMixin","CSS","DataStore","DOM","DOMQuery","Event","Focus","Input","Keys","Parent","StickyPlaceholderInput","Style","TextMetrics","Token","UserAgent","WeakToken","copyProperties","createObjectFrom","emptyFunction","mixin"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('CSS'),j=b('DataStore'),k=b('DOM'),l=b('DOMQuery'),m=b('Event'),n=b('Focus'),o=b('Input'),p=b('Keys'),q=b('Parent'),r=b('StickyPlaceholderInput'),s=b('Style'),t=b('TextMetrics'),u=b('Token'),v=b('UserAgent'),w=b('WeakToken'),x=b('copyProperties'),y=b('createObjectFrom'),z=b('emptyFunction'),aa=20,ba=b("mixin"),ca=ba(h);for(var da in ca)if(ca.hasOwnProperty(da)&&da!=="_metaprototype")fa[da]=ca[da];var ea=ca===null?null:ca.prototype;fa.prototype=Object.create(ea);fa.prototype.constructor=fa;fa.__superConstructor__=ca;function fa(ga,ha){this.element=ga;this.typeahead=ha;this.input=ha.getCore().getElement();j.set(this.element,'Tokenizer',this);}fa.prototype.init=function(ga,ha,ia,ja){this.init=z;this.tokenarea=ga;this.paramName=ha;if(!this.placeholder)this.placeholder=this.input.getAttribute('data-placeholder')||'';x(this,ja||{});this.initEvents();this.initTypeahead();this.reset(ia);this.initBehaviors();this.adjustWidth.bind(this).defer();g.inform('Tokenizer/init',this,g.BEHAVIOR_PERSISTENT);};fa.prototype.reset=function(ga){this.tokens=[];this.unique={};if(ga){this.populate(ga);}else k.empty(this.tokenarea);this.updateTokenarea();};fa.prototype.populate=function(ga){var ha=[];this.tokens=this.getTokenElements().map(function(ia,ja){var ka=ga[ja];ha.push(this._tokenKey(ka));return this.createToken(ka,ia);},this);this.unique=y(ha,this.tokens);};fa.prototype.getElement=function(){return this.element;};fa.prototype.getTypeahead=function(){return this.typeahead;};fa.prototype.getInput=function(){return this.input;};fa.prototype.initBehaviors=function(){this.behaviors=this.behaviors||[];if(this.behaviors instanceof Array){this.behaviors.forEach(function(ia){ia.behavior(this,ia.config);}.bind(this));}else for(var ga in (this.behaviors||{})){var ha=window.TokenizerBehaviors&&window.TokenizerBehaviors[ga];ha.call(null,this,this.behaviors[ga]);}};fa.prototype.initTypeahead=function(){var ga=this.typeahead.getCore();ga.resetOnSelect=true;ga.setValueOnSelect=false;ga.preventFocusChangeOnTab=true;if(this.inline){var ha=this.typeahead.getView();i.addClass(ha.getElement(),'uiInlineTokenizerView');}this.typeahead.subscribe('select',function(ia,ja){var ka=ja.selected;if('uid' in ka){this.updateInput();this.addToken(this.createToken(ka));}}.bind(this));this.typeahead.subscribe('blur',this.handleBlur.bind(this));};fa.prototype.handleBlur=function(event){this.inform('blur',{event:event});this.updatePlaceholder();};fa.prototype.initEvents=function(){var ga=this.handleEvents.bind(this),ha=v.firefox()<4?'keypress':'keydown';m.listen(this.tokenarea,{click:ga,keydown:ga});m.listen(this.input,'paste',this.paste.bind(this));m.listen(this.input,ha,this.keydown.bind(this));};fa.prototype.handleEvents=function(event){var ga=event.getTarget(),ha=ga&&this.getTokenElementFromTarget(ga);if(!ha)return;if(event.type!='keydown'||m.getKeyCode(event)==p.RETURN)this.processEvents(event,ga,ha);};fa.prototype.processEvents=function(event,ga,ha){if(q.byClass(ga,'remove')){var ia=ha.nextSibling;ia=ia&&l.scry(ha.nextSibling,'.remove')[0];var ja=this.getTokenFromElement(ha);ja=this.addTokenData(ja,ga);this.removeToken(ja);this.focusOnTokenRemoval(event,ia);event.kill();}};fa.prototype.focusOnTokenRemoval=function(event,ga){n.set(event.type=='keydown'&&ga||this.input);};fa.prototype.addTokenData=function(ga,ha){return ga;};fa.prototype.keydown=function(event){this.inform('keydown',{event:event});var ga=m.getKeyCode(event),ha=this.input;if(this.inline&&ga==p.BACKSPACE&&o.isEmpty(ha)){var ia=this.getLastToken();if(ia&&ia.isRemovable())this.removeToken(ia);}this.updateInput();};fa.prototype.paste=function(event){this.inform('paste',{event:event});this.updateInput(true);};fa.prototype.focusInput=function(){n.set(this.input);};fa.prototype.updateInput=function(ga){if(!this.inline)return;setTimeout(function(){this.adjustWidth(this.input.value);if(ga)this.input.value=this.input.value;}.bind(this),20);r.setPlaceholderText(this.input,'');this.inform('resize');};fa.prototype.setPlaceholder=function(ga){this.placeholder=ga;if(this.stickyPlaceholder)r.setPlaceholderText(this.input,ga);this.updatePlaceholder();};fa.prototype.updatePlaceholder=function(){if(!this.inline||this.input.value)return;var ga=!this.tokens.length,ha='';if(ga||this.stickyPlaceholder){this.adjustWidth(this.placeholder);ha=this.placeholder;}else this.adjustWidth(this.input.value);r.setPlaceholderText(this.input,ha);};fa.prototype.adjustWidth=function(ga){if(!this.inline||!this._getIsInDOM())return;if(!ga&&this.input.value==='')ga=this.placeholder;var ha=aa;if(ga!==this.placeholder||!this.getTokens().length||this.stickyPlaceholder){var ia=this._getMetrics().measure(ga);ha=ia.width+this._getWidthOffset()+10;}s.set(this.input,'width',ha+'px');this.inform('resize');};fa.prototype.getToken=function(ga){return this.unique[ga]||null;};fa.prototype.getTokens=function(){return this.tokens||[];};fa.prototype.getTokenElements=function(){return l.scry(this.tokenarea,'span.uiToken');};fa.prototype.getTokenElementFromTarget=function(ga){return q.byClass(ga,'uiToken');};fa.prototype.getTokenFromElement=function(ga){return j.get(ga,'Token');};fa.prototype.getTokenValues=function(){if(!this.tokens)return [];return this.tokens.map(function(ga){return ga.getValue();});};fa.prototype.getFirstToken=function(){return this.tokens[0]||null;};fa.prototype.getLastToken=function(){return this.tokens[this.tokens.length-1]||null;};fa.prototype.hasMaxTokens=function(){return this.maxTokens&&this.maxTokens<=this.tokens.length;};fa.prototype.createToken=function(ga,ha){var ia=this.getToken(this._tokenKey(ga));if(!ia)ia=ga.weak_reference?new w(ga,this.paramName):new u(ga,this.paramName);ha&&ia.setElement(ha);return ia;};fa.prototype.addToken=function(ga){if(this.hasMaxTokens())return;var ha=this._tokenKey(ga.getInfo());if(ha in this.unique)return;this.unique[ha]=ga;this.tokens.push(ga);this.insertToken(ga);this.updateTokenarea();this.inform('addToken',ga);g.inform('Form/change',{node:this.element});};fa.prototype.insertToken=function(ga){k.appendContent(this.tokenarea,ga.getElement());};fa.prototype.removeToken=function(ga){if(!ga)return;var ha=this.tokens.indexOf(ga);if(ha<0)return;this.tokens.splice(this.tokens.indexOf(ga),1);delete this.unique[this._tokenKey(ga.getInfo())];k.remove(ga.getElement());this.updateTokenarea();this.inform('removeToken',ga);g.inform('Form/change',{node:this.element});};fa.prototype.removeAllTokens=function(){this.reset();this.inform('removeAllTokens');};fa.prototype.updateTokenarea=function(){var ga=this.typeahead.getCore(),ha=this.getTokenValues();if(this.excludeDuplicates){this._exclusions||(this._exclusions=ga.getExclusions());ga.setExclusions(ha.concat(this._exclusions));}ga.setEnabled(!this.hasMaxTokens());this.updateTokenareaVisibility();this.updatePlaceholder();this.inform('resize');};fa.prototype.updateTokenareaVisibility=function(){i.conditionShow(this.tokenarea,this.tokens.length!==0);};fa.prototype._tokenKey=function(ga){return ga.uid+(ga.freeform?':':'');};fa.prototype._getWidthOffset=function(){if(this._widthOffset===null){var ga=this.input.clientWidth,ha=s.getFloat(this.input,'width');if(ga==ha){this._widthOffset=s.getFloat(this.input,'paddingLeft')+s.getFloat(this.input,'paddingRight');}else this._widthOffset=0;}return this._widthOffset;};fa.prototype._getMetrics=function(){if(!this._metrics)this._metrics=new t(this.input,this.inline);return this._metrics;};fa.prototype._getIsInDOM=function(){return this._isInDOM||(this._isInDOM=l.contains(document.body,this.input));};fa.getInstance=function(ga){var ha=q.byClass(ga,'uiTokenizer');return ha?j.get(ha,'Tokenizer'):null;};fa.init=function(ga,ha){ga.init(ha.tokenarea,ha.param_name,ha.initial_info,ha.options);};x(fa.prototype,{inline:false,maxTokens:null,excludeDuplicates:true,placeholder:'',_widthOffset:null,_metrics:null});e.exports=fa;});
__d("runAfterScrollingStops",["Arbiter","Event","Run","debounceAcrossTransitions","emptyFunction"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Event'),i=b('Run'),j=b('debounceAcrossTransitions'),k=b('emptyFunction');function l(w,x,y){if(x&&o[x])return;if(!n){g.subscribe('page_transition',v);n=true;}if(!m){w();return;}x&&(o[x]=1);p.push(w);if(!y){if(r){i.onLeave(v);r=false;}q.push(p.length-1);}}var m,n,o={},p=[],q=[],r=true,s=500,t=j(function(){m=false;var w=p;p=[];q=[];o={};for(var x=0,y=w.length;x<y;++x)w[x]();},s);function u(){m=true;t();}function v(){var w=q;q=[];r=true;for(var x=0,y=w.length;x<y;++x)p[w[x]]=k;}h.listen(window,'scroll',u);e.exports=l;});
__d("PhotosUploadWaterfall",["AsyncSignal"],function(a,b,c,d,e,f){var g=b('AsyncSignal'),h={APP_FLASH:'flash_pro',APP_SIMPLE:'simple',APP_ARCHIVE:'archive',APP_COMPOSER:'composer',APP_MESSENGER:'messenger',APP_HTML5:'html5',APP_CHAT:'chat',INSTALL_CANCEL:1,INSTALL_INSTALL:2,INSTALL_UPDATE:3,INSTALL_REINSTALL:4,INSTALL_PERMA_CANCEL:5,INSTALL_SILENT_SKIP:6,INSTALL_DOWNLOAD:7,CERROR_RESIZING_FAILED:6,CERROR_MARKER_EXTRACTION_FAILED:9,BEGIN:1,UPLOAD_START:4,ALL_UPLOADS_DONE:6,CLIENT_ERROR:7,RECOVERABLE_CLIENT_ERROR:12,IMAGES_SELECTED:9,UPGRADE_REQUIRED:11,VERSION:15,SELECT_START:18,SELECT_CANCELED:19,CANCEL:22,CANCEL_DURING_UPLOAD:83,ONE_RESIZING_START:2,ONE_UPLOAD_START:10,ONE_UPLOAD_DONE:29,ONE_RESIZING_DONE:34,PROGRESS_BAR_STOPPED:44,MISSED_BEAT:45,HEART_ATTACK:46,PUBLISH_START:100,PUBLISH_SUCCESS:101,PUBLISH_FAILURE:102,SESSION_POSTED:72,POST_PUBLISHED:80,ONE_UPLOAD_CANCELED:81,ONE_UPLOAD_CANCELED_DURING_UPLOAD:82,RESIZER_AVAILABLE:20,OVERLAY_FIRST:61,ASYNC_AVAILABLE:63,FALLBACK_TO_FLASH:13,RETRY_UPLOAD:17,TAGGED_ALL_FACES:14,VAULT_IMAGES_SELECTED:62,VAULT_CREATE_POST_CANCEL:65,VAULT_SEND_IN_MESSAGE_CLICKED:66,VAULT_DELETE_CANCEL:68,VAULT_ADD_TO_ALBUM_CANCEL:74,VAULT_SHARE_IN_AN_ALBUM_CLICKED:76,VAULT_SHARE_OWN_TIMELINE_CLICKED:77,VAULT_SHARE_FRIENDS_TIMELINE_CLICKED:78,VAULT_SHARE_IN_A_GROUP_CLICKED:79,VAULT_SYNCED_PAGED_LINK_CLICKED:84,METHOD_DRAGDROP:'dragdrop',METHOD_FILE_SELECTOR:'file_selector',METHOD_VAULT:'vault',METHOD_PHOTOS_OF_YOU:'photos_of_you',METHOD_RECENT_PHOTOS:'recent_photos',VAULTBOX:'vaultbox',GRID:'grid',SPOTLIGHT_VAULT_VIEWER:'spotlight_vault_viewer',REF_VAULT_NOTIFICATION:'vault_notification',sendSignal:function(i,j){new g('/ajax/photos/waterfall.php',{data:JSON.stringify(i)}).setHandler(j).send();}};e.exports=h;});