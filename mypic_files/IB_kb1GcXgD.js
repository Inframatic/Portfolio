/*1375071116,173214295*/

if (self.CavalryLogger) { CavalryLogger.start_js(["qjEJn"]); }

__d("Collection",[],function(a,b,c,d,e,f){function g(h,i){if(!h.__collection__){var j=new Function();for(var k in h.prototype)j.prototype[k]=g._call.bind(null,k);h.__collection__=j;}var l=new h.__collection__();l._elements=i;return l;}g._call=function(h){var i=Array.prototype.slice.call(arguments,1);this._elements.forEach(function(j){j[h].apply(j,i);});return this;};e.exports=g;});
__d("Drag",["Event","Arbiter","DOM","Style","Vector"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('DOM'),j=b('Style'),k=b('Vector'),l={};l.currentDraggable=null;l.grab=function(m){if(l.currentDraggable)l._onmouseup();m.lastDragOver=null;l.attachDragEvents();l.currentDraggable=m;};l.attachDragEvents=function(){document.onselectstart=function(){document.onselectstart=null;return false;};if(l.dragEventsAttached)return;l.dragEventsAttached=true;h.subscribe('scroller/scroll',l._onmousemove);g.listen(document,{mousemove:l._onmousemove,mouseup:l._onmouseup});};l.droppables={};l.addDroppable=function(m,n){(l.droppables[m]=l.droppables[m]||[]).push(n);};l.removeDroppable=function(m,n){l.droppables[m]=l.droppables[m].filter(function(o){return o!=n;});};l.getOffsetParent=function(m){if(i.isNodeOfType(m,['body','html']))return document.body;while((m=m.parentNode)&&m!==document.body)if(j.get(m,'position')!=='static')return m;return document.body;};l._onmousemove=function(event,m){if(!l.currentDraggable)return;var n=m||k.getEventPosition(event),o=l.currentDraggable,p=l.droppables[o.namespace];if(o.namespace&&o.active&&p){var q={};p.forEach(function(w){q[w.zIndex]=w.zIndex;});var r=[];for(var s in q)r.push(q[s]);r.sort();var t=o.lastDragOver,u=null;for(var v=r.length-1;v>=0;v--)if(t&&t.dom!=null&&t.zIndex==r[v]&&t.pointInside(n)){u=t;break;}else for(s=0;s<p.length;s++){if(r[v]!=p[s].zIndex)continue;if(t!=p[s]&&o.dom!=p[s].dom&&p[s].pointInside(n)){u=p[s];v=-1;break;}}if(u&&u!=t){u.ondragover(o);l.currentDraggable.adjustCursorPosition();}if(u)u.ondragmove(o,n.sub(k.getElementPosition(u.dom)));o.lastDragOver=u;}l.currentDraggable._onmousemove(n);};l._onmouseup=function(m){document.onselectstart=null;if(l.currentDraggable){l.currentDraggable._ondrop();l.currentDraggable=null;}};e.exports=l;});
__d("Draggable",["Event","Arbiter","Collection","DOM","Drag","Rect","Style","Vector","emptyFunction"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('Collection'),j=b('DOM'),k=b('Drag'),l=b('Rect'),m=b('Style'),n=b('Vector'),o=b('emptyFunction');function p(s){this.canvas=s;this.scrollZone=50;this.velocity=100;this.coefficient=1;}p.findScrollParent=function(s){var t;s=s.parentNode;while(s){if(s.scrollHeight!=s.offsetTop){t=m.get(s,'overflowY');if(t=='scroll'||t=='auto')return s;}s=s.parentNode;}return document.body;};p.prototype.activate=function(){this.activate=o;this.event=g.listen(document,'mousemove',this._onmousemove.bind(this));this.interval=setInterval(this._intervalHandler.bind(this),50);this.cursor=null;};p.prototype.deactivate=function(){delete this.activate;this.event&&this.event.remove();this.event=null;clearInterval(this.interval);};p.prototype._onmousemove=function(event){this.cursor=new n.getEventPosition(event);};p.prototype._intervalHandler=function(){if(!this.cursor)return;var s=this.canvas==document.body?l.getViewportBounds():new l(this.canvas),t=new l(this.cursor.y-s.t,s.r-this.cursor.x,s.b-this.cursor.y,this.cursor.x-s.l),u=new n(0,0);if(t.t<t.b&&t.t<this.scrollZone){u.y=-this.scrollZone+t.t;}else if(t.b<this.scrollZone)u.y=this.scrollZone-t.b;u.y=this._doMath(u.y);if(t.l<t.r&&t.l<this.scrollZone){u.x=-this.scrollZone+t.l;}else if(t.r<this.scrollZone)u.x=this.scrollZone-t.r;u.x=this._doMath(u.x);if(u.x||u.y){u.scrollElementBy(this.canvas);if(document.body==this.canvas)this.cursor=this.cursor.add(u);h.inform('scroller/scroll',this.cursor);}};p.prototype._doMath=function(s){s=(s>=0?Math.min(s,this.scrollZone):Math.max(s,-this.scrollZone));return Math.floor(Math.pow(s/this.scrollZone*this.velocity,this.coefficient));};function q(s){if(!s)throw new Error('Element should be a DOM node');if(!(this instanceof q)){if(s instanceof Array){var t=[];s.forEach(function(u){t.push(new q(u));});return new i(q,t);}else return new q(s);}else{this.data={};this.handles=[];this.dom=s;this.boundingBox=null;this.useScroller=true;this.grabPctX=this.grabPctY=0;this.addHandle(this.dom);}}q.prototype.destroy=function(){this.handles.forEach(function(s){this.removeHandle(s.obj);}.bind(this));this.data=this.dom=null;};q.prototype.adjustCursorPosition=function(){var s=n.getElementDimensions(this.dom);this.cursorPositionVector=new n(parseInt(this.grabPctX*s.x,10),parseInt(this.grabPctY*s.y,10));};q.prototype._onclick=function(event){if(this.active)return g.kill(event);};q.prototype._ongrab=function(s){this.ongrab();if(this.useScroller){if(!this.scroller)this.scroller=new p(p.findScrollParent(this.dom));this.scroller.activate();}if(this.active){if(!this.oldPosition)this.oldPosition=this.dom.style.position;this.dom.style.position=this.absolute?'absolute':'relative';s.sub(this.cursorPositionVector).setElementPosition(this.dom);}};q.prototype._onmousedown=function(event){if(!((event.which&&event.which===1)||(event.button&&event.button===1)))return;var s=event.getTarget();if(j.isNodeOfType(s,['input','select','textarea','object','embed']))return true;var t=n.getEventPosition(event),u=n.getElementDimensions(this.dom);this.draggableInitialVector=n.getElementPosition(this.dom);this.cursorPositionVector=t.sub(this.draggableInitialVector);this.grabPctX=u.x===0?0:this.cursorPositionVector.x/u.x;this.grabPctY=u.y===0?0:this.cursorPositionVector.y/u.y;k.grab(this,event);if(this.gutter){this.cursorInitialVector=t;}else{this._setActive(true);this._ongrab(t);}return g.kill(event);};q.prototype._onmousemove=function(s){if(!this.active)if(s.distanceTo(this.cursorInitialVector)>=this.gutter){this._setActive(true);this._ongrab(s);}if(this.active){var t=s.sub(this.cursorPositionVector),u;if(this.boundingBox){var v=l.newFromVectors(t,n.getElementDimensions(this.dom));v=v.boundWithin(this.boundingBox);t=v.getPositionVector();if(this.boundingBox.w()===0){u=new n(this.draggableInitialVector.x,t.y,'document');}else if(this.boundingBox.h()===0){u=new n(t.x,this.draggableInitialVector.y,'document');}else u=t;}else u=t;var w=k.getOffsetParent(this.dom);if(w!==document.body)u=u.sub(n.getElementPosition(w));u.setElementPosition(this.dom);this.ondrag(s);}};q.prototype._ondrop=function(){this.scroller&&this.scroller.deactivate();if(this.active){(function(){this._setActive(false);}).bind(this).defer();this.ondrop();if(this.lastDragOver)this.lastDragOver.ondrop(this);}};q.prototype.killDrag=function(){this._setActive(false);k._onmouseup();};q.prototype.setBoundingBox=function(s){this.boundingBox=s;return this;};q.prototype.resetPosition=function(){this.dom.style.position=this.oldPosition;this.oldPosition=null;this.dom.style.left='';this.dom.style.top='';return this;};q.prototype.setUseAbsolute=function(s){this.absolute=s;return this;};q.prototype.ondrag=o;q.prototype.setDragHandler=function(s){this.ondrag=s;return this;};q.prototype.ongrab=o;q.prototype.setGrabHandler=function(s){this.ongrab=s;return this;};q.prototype.ondrop=o;q.prototype.setDropHandler=function(s){this.ondrop=s;return this;};q.prototype.gutter=0;q.prototype.setGutter=function(s){this.gutter=s;return this;};q.prototype.setNamespace=function(s){this.namespace=s;return this;};q.prototype.setUseScroller=function(s){this.useScroller=s;return this;};q.prototype.handles=null;q.prototype.addHandle=function(s){if(this.handles.length==1&&this.handles[0].obj==this.dom)this.removeHandle(this.dom);this.handles.push({obj:s,evt:[g.listen(s,'mousedown',this._onmousedown.bind(this)),g.listen(s,'click',this._onclick.bind(this)),g.listen(s,'drag',r),g.listen(s,'selectstart',r)]});return this;};function r(s){if(s.getTarget()!==document.activeElement)return s.kill();}q.prototype.removeHandle=function(s){this.handles=this.handles.filter(function(t){if(t.obj!=s){return true;}else{t.evt.forEach(function(u){u.remove();});return false;}});};q.prototype.getDOM=function(){return this.dom;};q.prototype.setKey=function(s,t){this.data[s]=t;return this;};q.prototype.getKey=function(s){return this.data[s];};q.prototype._setActive=function(s){this.dom.activeDrag=this.active=s;for(var t=0;t<this.handles.length;t++)this.handles[t].obj.activeDrag=s;};e.exports=q;});
__d("Droppable",["Collection","Drag","Draggable","Vector","emptyFunction"],function(a,b,c,d,e,f){var g=b('Collection'),h=b('Drag'),i=b('Draggable'),j=b('Vector'),k=b('emptyFunction');function l(m){if(!m)throw new Error('Element should be a DOM node');if(!(this instanceof l)){if(m instanceof Array){var n=[];m.forEach(function(o){n.push(new l(o));});return new g(l,n);}else return new l(m);}else{this.data={};this.dom=m;this.namespace=null;}}l.prototype.destroy=function(){if(this.namespace)h.removeDroppable(this.namespace,this);this.data=this.dom=null;};l.prototype.setNamespace=function(m){if(this.namespace)h.removeDroppable(this.namespace,this);this.namespace=m;h.addDroppable(m,this);return this;};l.prototype.zIndex=0;l.prototype.setZIndex=function(m){this.zIndex=m;return this;};l.prototype.pointInside=function(m){var n=j.getElementPosition(this.dom);return n.x<=m.x&&this.dom.offsetWidth+n.x>m.x&&n.y<=m.y&&this.dom.offsetHeight+n.y>m.y;};l.prototype.ondragover=k;l.prototype.setDragOverHandler=function(m){this.ondragover=m;return this;};l.prototype.ondragmove=k;l.prototype.setDragMoveHandler=function(m){this.ondragmove=m;return this;};l.prototype.ondrop=k;l.prototype.setDropHandler=function(m){this.ondrop=m;return this;};l.prototype.getDOM=i.prototype.getDOM;l.prototype.setKey=i.prototype.setKey;l.prototype.getKey=i.prototype.getKey;e.exports=l;});
__d("SortableGroup",["CSS","DOM","Draggable","Droppable","Style","Vector","copyProperties","emptyFunction","removeFromArray"],function(a,b,c,d,e,f){var g=b('CSS'),h=b('DOM'),i=b('Draggable'),j=b('Droppable'),k=b('Style'),l=b('Vector'),m=b('copyProperties'),n=b('emptyFunction'),o=b('removeFromArray');function p(){this.namespace='sortable'+(++p.instanceCount);this.draggables={};this.droppables={};this.sortables={};this.linkedGroups=[];this.linkedGroups.onbeforelinkjump=n;this.linkedGroups.onlinkjump=n;this.rootNode=null;this.boundingBox=null;this.neverEmpty=false;this.hasEmptyMessage=false;this.isDroppable=true;this.isDraggable=true;this.requireSameParent=true;this.anchor=null;this.disabled=false;this.autoWidth=false;}p.instanceCount=0;m(p.prototype,{gutter:15,onbeforegrabcallback:n,onbeforedragover:n,ondragover:n,ondropcallback:n,ongrabcallback:n,onorderchange:n,addEmptyMessage:function(q,r){var s='placeholder';if(q.parentNode!=r)h.appendContent(r,q);this.emptyMessage=q;this._initializeAdded(s,q);this.hasEmptyMessage=true;this.sortables[s]=q;this.droppables[s]=(new j(q)).setNamespace(this.namespace).setDragOverHandler(this._dragOverHandlerShim.bind(this,s));return this;},setAutoWidth:function(q){this.autoWidth=q;},removeEmptyMessage:function(){if(this.emptyMessage)o(h,this.emptyMessage);this.hasEmptyMessage=false;this.removeSortable('placeholder');return this;},addSortable:function(q,r,s){this._initializeAdded(q,r);this.sortables[q]=r;this.draggables[q]=(new i(r)).setNamespace(this.namespace).setGutter(this.gutter).setUseAbsolute(true).setGrabHandler(this.grabHandler.bind(this,q)).setDropHandler(this.dropHandler.bind(this,q)).setKey('key',q).setBoundingBox(this.boundingBox);if(s)this.draggables[q].addHandle(s);this.droppables[q]=(new j(r)).setNamespace(this.namespace).setDragOverHandler(this._dragOverHandlerShim.bind(this,q));return this;},destroy:function(){for(var q in this.droppables)this.droppables[q].destroy();for(var r in this.draggables)this.draggables[r].destroy();this.droppables=this.draggables=this.rootNode=null;o(this.linkedGroups,this);for(var s=0;s<this.linkedGroups.length;s++)this.linkedGroups[s].linkedGroups=this.linkedGroups;},dragOverHandler:function(q,r){if(!this.isDroppable&&!this.anchor)return;var s=false;if(!(r in this.draggables)){this.linkedGroups.onbeforelinkjump.call(this,r);if(!this.migrateLinkedSortable(r))throw new Error('Draggable dropped onto a foreign droppable!');s=true;}var t=true,u=this.getSortables(),v=this.sortables[r],w=this.sortables[q];if(!this.anchor){var x=u.length;for(var y=0;y<x;y++)if(u[y]==w){break;}else if(u[y]==v){t=false;break;}}else w=this.anchor;this.onbeforedragover(v,w);var z=this.linkedGroups.placeholder;this.insertPlaceholder(z,w,t||this.anchor);z.parentNode.insertBefore(v,z);this.ondragover(v,w);if(s)this.linkedGroups.onlinkjump.call(this,r);},dropHandler:function(q){if(this._checkLastRemaining()){this.draggables[q].resetPosition();return;}var r=this.linkedGroups.placeholder;g.removeClass(this.sortables[q],'drag');this.draggables[q].resetPosition();r.parentNode.insertBefore(this.sortables[q],r);r.parentNode.removeChild(r);for(var s=0;s<this.linkedGroups.length;s++)if(this.linkedGroups[s].anchor)delete this.linkedGroups[s].anchor;this.ondropcallback(q,this.sortables[q]);this.onorderchange();},getOrder:function(){var q=[],r=this.getSortables();for(var s=0;s<r.length;s++)for(var t in this.sortables)if(this.sortables[t]==r[s]){q.push(t);break;}return q;},getSortables:function(){return this.rootNode?this.rootNode.childNodes:[];},grabHandler:function(q){if(this.disabled||this._checkLastRemaining()||!this.isDraggable){this.draggables[q].killDrag();return;}this.onbeforegrabcallback(this.sortables[q],q);var r=this.linkedGroups.placeholder,s=this.sortables[q];g.setClass(r,s.className);g.addClass(r,'droppable_placeholder');g.addClass(s,'drag');l.getElementDimensions(s).setElementDimensions(r);if(this.autoWidth)k.set(r,'width','auto');s.parentNode.insertBefore(r,s);this.ongrabcallback(this.sortables[q],q);if(!this.isDroppable){this.anchor=s.nextSibling;if(!this.anchor){this.anchor=h.create('div');s.parentNode.appendChild(this.anchor);}}},insertPlaceholder:function(q,r,s){if(s){h.insertBefore(r,q);}else h.insertAfter(r,q);},keyExists:function(q){return this.sortables[q];},link:function(q){q.linkedGroups=this.linkedGroups;if(!this.linkedGroups.length)this.linkedGroups.push(this);this.linkedGroups.push(q);for(var r=0;r<this.linkedGroups.length;r++)if(this.linkedGroups[r].namespace!=this.namespace){this.linkedGroups[r].namespace=this.namespace;for(var s in this.linkedGroups[r].droppables){this.linkedGroups[r].droppables[s].setNamespace(this.namespace);var t=this.linkedGroups[r].draggables[s];t&&t.setNamespace(this.namespace);}}return this;},migrateLinkedSortable:function(q){for(var r=0;r<this.linkedGroups.length;r++)if(q in this.linkedGroups[r].draggables){this.sortables[q]=this.linkedGroups[r].sortables[q];this.draggables[q]=this.linkedGroups[r].draggables[q];this.draggables[q].setGrabHandler(this.grabHandler.bind(this,q)).setDropHandler(this.dropHandler.bind(this,q));this.droppables[q]=this.linkedGroups[r].droppables[q];this.droppables[q].setDragOverHandler(this._dragOverHandlerShim.bind(this,q));delete this.linkedGroups[r].sortables[q];delete this.linkedGroups[r].draggables[q];delete this.linkedGroups[r].droppables[q];return true;}return false;},removeSortable:function(q){if(q in this.sortables){if(q in this.draggables)this.draggables[q].destroy();if(q in this.droppables)this.droppables[q].destroy();delete this.draggables[q];delete this.droppables[q];delete this.sortables[q];}},setDisabled:function(q){this.disabled=q;return this;},forceDrop:function(q){if(q in this.sortables)this.draggables[q].killDrag();},setBeforeGrabCallback:function(q){this.onbeforegrabcallback=q;return this;},setBoundingBox:function(q){this.boundingBox=q;for(var r in this.draggables)this.draggables[r].setBoundingBox(this.boundingBox);return this;},setBeforeDragOverCallback:function(q){this.onbeforedragover=q;return this;},setDragOverCallback:function(q){this.ondragover=q;return this;},setDropCallback:function(q){this.ondropcallback=q;return this;},setDroppable:function(q){this.isDroppable=q;return this;},setDraggable:function(q){this.isDraggable=q;return this;},setGrabCallback:function(q){this.ongrabcallback=q;return this;},setBeforeLinkJumpHandler:function(q){this.linkedGroups.onbeforelinkjump=q;return this;},setInsertPlaceholderHandler:function(q){this.insertPlaceholder=q;},setLinkJumpHandler:function(q){this.linkedGroups.onlinkjump=q;return this;},setNeverEmpty:function(q){this.neverEmpty=q;},setOrderChangeHandler:function(q){this.onorderchange=q;return this;},setRequireSameParent:function(q,r){this.requireSameParent=r;},setSortablesGetter:function(q){this.getSortables=q;},_checkLastRemaining:function(q){var r=this.hasEmptyMessage?2:1;return this.neverEmpty&&this.getSortables().length==r;},_dragOverHandlerShim:function(q,r){this.dragOverHandler(q,r.getKey('key'));},_initializeAdded:function(q,r){if(this.rootNode===null){this.rootNode=r.parentNode;if(!this.linkedGroups.placeholder)this.linkedGroups.placeholder=h.create(r.tagName,{className:'dragPlaceholder',style:{padding:'0'}});}else if(this.requireSameParent&&this.rootNode!=r.parentNode)throw new Error('All sortables of a collection must share the same parentNode');if(q in this.draggables)throw new Error('All sortables must have a unique key');}});e.exports=a.SortableGroup||p;});
__d("runAfterCSSTransition",["BrowserSupport","DataStore","DOM","Event","Run"],function(a,b,c,d,e,f){var g=b('BrowserSupport'),h=b('DataStore'),i=b('DOM'),j=b('Event'),k=b('Run'),l;if(g.hasCSSTransitions()){l=function(m,n){var o=h.get(m,'runAfterCSSTransition');if(o)return o;var p,q=j.listen(m,g.getTransitionEndEvent(),function(event){if(event.getTarget()!==m)return;p&&p();p=null;});if(!n)k.onLeave(function(){q.remove();q=null;p=null;h.remove(m,'runAfterCSSTransition');});var r=i.getID(m);o=function(s){if(!q)return;p=s;};h.set(m,'runAfterCSSTransition',o);return o;};}else l=function(){return function(m){m();};};e.exports=l;});
__d("LitestandSectionNav",["Arbiter","ArbiterMixin","AsyncRequest","BrowserSupport","ContextualDialog","CSS","DOM","DOMDimensions","DOMPosition","DOMQuery","Event","Focus","JSXDOM","Keys","KeyStatus","LitestandMessages","Parent","Rect","Run","SortableGroup","Style","SubscriptionsHandler","Vector","copyProperties","csx","cx","queryThenMutateDOM","requestAnimationFrame","runAfterCSSTransition","throttle"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('ArbiterMixin'),i=b('AsyncRequest'),j=b('BrowserSupport'),k=b('ContextualDialog'),l=b('CSS'),m=b('DOM'),n=b('DOMDimensions'),o=b('DOMPosition'),p=b('DOMQuery'),q=b('Event'),r=b('Focus'),s=b('JSXDOM'),t=b('Keys'),u=b('KeyStatus'),v=b('LitestandMessages'),w=b('Parent'),x=b('Rect'),y=b('Run'),z=b('SortableGroup'),aa=b('Style'),ba=b('SubscriptionsHandler'),ca=b('Vector'),da=b('copyProperties'),ea=b('csx'),fa=b('cx'),ga=b('queryThenMutateDOM'),ha=b('requestAnimationFrame'),ia=b('runAfterCSSTransition'),ja=b('throttle'),ka=37,la=30,ma={COLLAPSED:0,DEFAULT:1,EXPANDED:2,EXPAND_ALL:3};function na(oa,pa){this._more=pa.more;this._moreIndex=pa.more&&parseInt(pa.more.getAttribute('data-index'),10);this._seeAll=pa.see_all;this._seeAllIndex=pa.first_see_all;this._selectedIndex=pa.selected;this._currentState=pa.collapsed?ma.COLLAPSED:ma.DEFAULT;this._originalState=this._currentState;this._showSeeAllDialog=pa.has_see_all_dialog||false;this._collapseOnDialog=pa.has_see_all_dialog&&pa.has_new_rhc;this._collapsedExtra=null;this._root=oa;this._wrap=m.find(this._root,"._3ozl");this._layoutRoot=p.find(document.body,"._li");var qa=m.scry(this._root,"._7gb");this._items={};this._itemsCount=qa.length;qa.forEach(function(ra){var sa=ra.getAttribute('data-index'),ta=ra.getAttribute('data-reorderable'),ua=ra.getAttribute('data-removable');this._items[sa]={element:ra,index:parseInt(sa,10),reorderable:ta,removable:ua};}.bind(this));this._runAfterTransition=ia(this._root);this.handler=new ba();this.handler.addSubscriptions(g.subscribe(v.EXPAND_FILTER_SWITCHER,function(){this.setState(ma.EXPANDED);}.bind(this)),g.subscribe(v.COLLAPSE_FILTER_SWITCHER,function(){this.setState(ma.COLLAPSED);}.bind(this)),g.subscribe(v.RESTORE_FILTER_SWITCHER,function(){if(this._previousState===ma.DEFAULT){this.setState(ma.DEFAULT);}else this.setState(ma.COLLAPSED);}.bind(this)),g.subscribe(v.UNLOCK_FILTER_SWITCHER,function(){this._locked=false;if(this._collapseOnDialog)this.collapse(false,true);this._onScroll();}.bind(this)),this.subscribe('state_change',this.stateChanged.bind(this)),q.listen(oa,'click',this._onClick.bind(this)));if(!pa.has_new_rhc)this.handler.addSubscriptions(q.listen(window,'scroll',ja(this._onScroll.bind(this))));if(pa.expanded)this.setState(ma.EXPANDED);y.onLeave(this.handler.release.bind(this.handler));}da(na.prototype,h,{destroy:function(){this.handler.release();},_update:function(oa,pa,qa,ra,sa,ta){pa=-pa*ka;oa=oa*ka-1;if(this._more&&(this._currentState===ma.DEFAULT||this._collapsedExtra!==null))oa-=12;var ua=function(){aa.set(this._root,'height',oa+'px');aa.set(this._wrap,'margin-top',pa+'px');}.bind(this);this.inform(qa,{height:oa});if(sa!==false&&j.hasCSSTransitions()){l.addClass(this._root,'animating');this._runAfterTransition(function(){l.removeClass(this._root,'animating');this.inform(ra,{height:oa});ta&&ta();}.bind(this));ha(ua);}else{ua();this.inform(ra,{height:oa});ta&&ta();}},_onScroll:function(event){var oa=null;ga(function(){var pa=-o.getElementPosition(this._layoutRoot).y;if(this._currentState===ma.EXPAND_ALL){var qa=o.getElementPosition(this._wrap).y,ra=qa+n.getElementDimensions(this._wrap).height,sa=ca.getViewportDimensions().y,ta=sa/2;if(qa<=ta&&ra+ta>sa)return;}if(this._currentState===ma.EXPAND_ALL||(this._currentState===ma.EXPANDED&&((this._originalState===ma.DEFAULT&&pa>la)||this._originalState!==ma.DEFAULT))||(this._currentState===ma.DEFAULT&&pa>la)){oa=ma.COLLAPSED;return;}if((this._originalState===ma.DEFAULT)&&((this._currentState===ma.COLLAPSED&&pa<=la)||this._currentState===ma.EXPANDED)){oa=ma.DEFAULT;return;}if(this._collapsedExtra!==null&&pa<=la){this._resetExtra(true);return;}}.bind(this),function(){this.setState(oa);}.bind(this));},_onClick:function(event){var oa=event.getTarget();if(m.contains(this._more,oa)){this.setState(ma.EXPANDED);return;}if(m.contains(this._seeAll,oa)){this.setState(ma.EXPAND_ALL);return;}var pa=w.byClass(oa,"_7gb");pa&&this.inform('click',{item:pa});if(!pa||event.isDefaultRequested())return;var qa=parseInt(pa.getAttribute('data-index'),10);if(qa===this._selectedIndex&&this._currentState===ma.COLLAPSED){this.setState(ma.EXPANDED);event.prevent();return;}if(qa===this._selectedIndex){if(this._currentState===ma.EXPANDED&&this._previousState===ma.DEFAULT){this.setState(ma.DEFAULT);}else if(this._currentState===ma.DEFAULT){this.setState(ma.EXPANDED);}else this.setState(ma.COLLAPSED);event.prevent();return;}},updateSelected:function(oa){if(!oa)return;if(this._currentState===ma.EXPAND_ALL)this.inform('reset');l.show(oa);var pa=parseInt(oa.getAttribute('data-index'),10);this.select(pa);if(pa&&this._currentState===ma.COLLAPSED&&this._collapsedExtra===null){if(this._moreIndex)if(pa>this._moreIndex){l.hide(this._more);pa--;}pa=Math.min(pa,this._seeAllIndex);aa.set(this._wrap,'margin-top',-pa*ka+'px');}if(this._collapsedExtra===pa&&this._currentState===ma.COLLAPSED){this._resetExtra(true);}else{this._resetExtra();this.setState(pa?ma.COLLAPSED:ma.DEFAULT);}this._originalState=this._currentState;},getRoot:function(){return this._root;},getItemAtIndex:function(oa){return this._items[oa];},getSelected:function(){if(!this._selected)this._selected=this.getItemAtIndex(this._selectedIndex);return this._selected;},getStates:function(){return ma;},isDefaultState:function(){return this._currentState===ma.DEFAULT;},isCollapsed:function(){return this._currentState===ma.COLLAPSED;},hasAllExpanded:function(){return this._currentState===ma.EXPAND_ALL;},previousStateWasDefault:function(){return this._previousState===ma.DEFAULT;},setState:function(oa,pa){if((!oa&&oa!==ma.COLLAPSED)||this._currentState===oa||this._locked)return;this._previousState=this._currentState;this._currentState=oa;this.inform('state_change',{animate:pa});l.conditionClass(this._root,"_3ozk",oa===ma.COLLAPSED);},stateChanged:function(oa,pa){var qa=pa.animate;switch(this._currentState){case ma.COLLAPSED:this.collapse(qa);break;case ma.DEFAULT:this.expandDefault(qa);break;case ma.EXPANDED:this.expand(qa);break;case ma.EXPAND_ALL:this.expandAll(qa);break;}},select:function(oa){var pa=this.getSelected();if(pa){var qa=pa.element;l.removeClass(qa,"_3ozj");}var ra=this.getItemAtIndex(oa);if(ra){var sa=ra.element;l.addClass(sa,"_3ozj");this._selected=ra;this._selectedIndex=oa;}},expand:function(oa,pa){this._resetExtra();this.inform('before_expand');for(var qa in this._items){var ra=this._items[qa].element,sa=this._items[qa].index,ta=(ra===this._more||(oa&&ra===this._seeAll)||(!oa&&this._seeAllIndex&&ra!==this._seeAll&&sa!==this._selectedIndex&&sa>this._seeAllIndex));l.conditionShow(ra,!ta);if(!ta)ra.tabIndex=0;}var ua=this._items[this._selectedIndex||0];if(ua)if(u.getKeyDownCode()===t.RETURN){r.set(ua.element);}else r.setWithoutOutline(ua.element);var va;if(oa){va=this._itemsCount-2;}else{va=this._seeAllIndex+1;if(this._selectedIndex>this._seeAllIndex)va+=1;}this._update(va,0,oa?'expand_all':'expand',oa?'expand_all_end':'expand_end',pa,function(){this.inform('after_expand');}.bind(this));this._enableEditing();},expandAll:function(){if(this._showSeeAllDialog){new i('/ajax/litestand/filter/chooser').setData({dom_id:m.getID(this._wrap)}).send();this._locked=true;this._currentState=ma.EXPANDED;this._feedStoreLoadingDialog=new k({context:this._wrap,position:'left'},s.div({className:"_59b-"},s.div({className:"_59b_"}))).show();}else{if(!this._seeAll)return;this.expand(true);}},expandDefault:function(oa){this._resetExtra();this._disableEditing();var pa=function(){for(var sa in this._items){var ta=this._items[sa].element,ua=this._items[sa].index;l.conditionShow(ta,!this._more||ua<=this._moreIndex);if(!this.more||ua<=this._moreIndex)ta.tabIndex=0;}}.bind(this),qa=null;if(this._previousState===ma.EXPANDED||this._previousState===ma.EXPAND_ALL){qa=pa;}else pa();var ra=this._previousState===ma.EXPANDED||this._previousState===ma.EXPAND_ALL;this._update(this._moreIndex+1,0,'expand','expand_end',oa,function(){qa&&qa();ra&&this.inform('after_collapse');}.bind(this));},collapse:function(oa,pa){this.inform('before_collapse');this._disableEditing();this._currentState=ma.COLLAPSED;var qa=function(){for(var ta in this._items){var ua=this._items[ta].element;ua.tabIndex=-1;var va=this._items[ta].index;if(va===this._selectedIndex||va===this._collapsedExtra){l.show(ua);ua.tabIndex=0;continue;}var wa;if(ua===this._more&&this._collapsedExtra!==null){wa=false;ua.tabIndex=0;}else wa=(ua===this._more&&this._selectedIndex>this._moreIndex)||(this._seeAllIndex&&va>this._seeAllIndex);l.conditionShow(ua,!wa);}this.inform('after_collapse');}.bind(this);if(pa){qa();qa=null;}var ra;if(this._seeAllIndex&&this._selectedIndex>this._seeAllIndex){ra=this._seeAllIndex;}else ra=this._selectedIndex-(this._selectedIndex>this._moreIndex?1:0);var sa=1;if(this._collapsedExtra!==null){sa+=2;if(this._collapsedExtra<this._selectedIndex)ra-=1;}this._update(sa,ra,'collapse','collapse_end',oa,qa);},_restoreMore:function(){if(!this._more)return;l.hide(this._more);m.insertAfter(this.getItemAtIndex(this._moreIndex-1).element,this._more);},_resetExtra:function(oa){if(this._collapsedExtra===null)return;var pa=this.getItemAtIndex(this._collapsedExtra).element;l.removeClass(this._root,"_54m7");l.removeClass(pa,"_54m5");l.removeClass(pa,"_54m6");if(this._collapsedExtra===0){m.prependContent(pa.parentNode,pa);this._restoreMore();}else{var qa=false;if(this._moreIndex<=this._collapsedExtra){this._restoreMore();qa=true;}m.insertAfter(this.getItemAtIndex(this._collapsedExtra-1).element,pa);qa||this._restoreMore();}this.inform('collapsed_extra',{hasExtra:false});this._collapsedExtra=null;oa&&this.collapse(false);},showAdditionalInCollapse:function(oa,pa){var qa=parseInt(oa.getAttribute('data-index'),10);if(this._currentState!==ma.COLLAPSED||this._selectedIndex===qa||this._collapsedExtra!==null)return;this.inform('collapsed_extra',{hasExtra:true});var ra=this.getItemAtIndex(qa).element;l.addClass(this._root,"_54m7");l.removeClass(ra,"_54m6");l.addClass(ra,"_54m5");m.insertAfter(this.getSelected().element,ra);if(this._more){l.show(this._more);m.insertAfter(ra,this._more);this._more.tabIndex=0;}this._collapsedExtra=qa;this.collapse(true,true);(function(){if(this._collapsedExtra!==null)l.addClass(ra,"_54m6");}.bind(this)).defer(pa);},_disableEditing:function(){this._sortableGroup&&this._sortableGroup.destroy();var oa;for(var pa in this._items){oa=this._items[pa];if(oa.reorderable)l.hide(m.find(oa.element,"._58p7"));if(oa.removable)l.hide(m.find(oa.element,"._58p6"));}this._editListeners&&this._editListeners.release();},_enableEditing:function(){this._sortableGroup=new z().setOrderChangeHandler(this._handleOrder.bind(this)).setDroppable(this._wrap).setDropCallback(function(sa,ta){aa.set(ta,'height','auto');aa.set(ta,'width','auto');}).setBeforeGrabCallback(function(sa){ca.getElementDimensions(sa).setElementDimensions(sa);var ta=new x(ca.getElementPosition(this._wrap).y,0,ca.getElementPosition(this._wrap).y+ca.getElementDimensions(this._wrap).y,0);this._sortableGroup.setBoundingBox(ta);}.bind(this));this._editListeners=new ba();for(var oa in this._items){var pa=this._items[oa];if(pa.reorderable){var qa=m.find(pa.element,"._58p7");this._sortableGroup.addSortable(pa.index,pa.element,qa);this._editListeners.addSubscriptions(q.listen(pa.element,'mouseover',l.show.curry(qa)),q.listen(pa.element,'mouseout',l.hide.curry(qa)));}if(pa.removable){var ra=m.find(pa.element,"._58p6");this._editListeners.addSubscriptions(q.listen(ra,'click',this._handleRemove.bind(this,pa)),q.listen(pa.element,'mouseover',l.show.curry(ra)),q.listen(pa.element,'mouseout',l.hide.curry(ra)));}}},_handleRemove:function(oa,event){this.inform('remove',{item:oa.element});event.kill();},_handleOrder:function(){this.inform('reorder',{sortables:this._sortableGroup.getSortables()});},hideLoadingDialog:function(){this._feedStoreLoadingDialog&&this._feedStoreLoadingDialog.destroy();}});e.exports=na;});
__d("LitestandStreamUnloader",["Event","Arbiter","DOM","DOMPosition","DOMQuery","LitestandMessages","LitestandStream","Run","$","csx","queryThenMutateDOM","throttle"],function(a,b,c,d,e,f){var g=b('Event'),h=b('Arbiter'),i=b('DOM'),j=b('DOMPosition'),k=b('DOMQuery'),l=b('LitestandMessages'),m=b('LitestandStream'),n=b('Run'),o=b('$'),p=b('csx'),q=b('queryThenMutateDOM'),r=b('throttle'),s=false,t,u,v,w,x={},y=[];function z(){n.onLeave(aa);y=[h.subscribe(l.FILTER_SWITCH_BEGIN,aa),h.subscribe(l.STORIES_INSERTED,ca)];s=true;}function aa(){y.forEach(h.unsubscribe);y=[];s=false;}function ba(){var ea=false,fa=[];clearTimeout(u);u=setTimeout(function(){q(function(){var ga=Math.abs(Math.min(j.getElementPosition(t).y,0));if(ga===0){ea=true;fa=i.scry(v,m.getStoriesSelector());}},function(){if(fa.length>x.oldStoriesLimit){fa.slice(x.oldStoriesLimit).forEach(i.remove);h.inform(l.STORIES_REMOVED);}if(ea){w&&w.remove();w=null;}},'LitestandStreamUnloader/removeOldStories');},x.oldStoriesDelay);}function ca(){ba();if(!w&&m.getVisibleStoryCount(v)>x.oldStoriesLimit)w=g.listen(window,'scroll',r(ba));}var da={register:function(ea,fa){s||z();x=m.getStreamConfig(fa);v=o(ea);t=k.scry(document.body,"._li")[0];}};e.exports=da;});