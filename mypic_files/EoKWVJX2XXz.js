/*1375078323,178183189*/

if (self.CavalryLogger) { CavalryLogger.start_js(["a33X\/"]); }

__d("NotificationURI",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={localize:function(i){i=g(i);if(!i.isFacebookURI())return i.toString();var j=i.getSubdomain();return i.getUnqualifiedURI().getQualifiedURI().setSubdomain(j).toString();},snowliftable:function(i){if(!i)return false;i=g(i);return i.isFacebookURI()&&i.getQueryData().hasOwnProperty('fbid');},isVaultSetURI:function(i){if(!i)return false;i=g(i);return i.isFacebookURI()&&i.getPath()=='/ajax/vault/sharer_preview.php';}};e.exports=h;});
__d("LitestandMessages",[],function(a,b,c,d,e,f){var g={FILTER_SWITCH_BEGIN:'LitestandMessages/FilterSwitchBegin',NEWSFEED_LOAD:'LitestandMessages/NewsFeedLoad',LEAVE_HOME:'LitestandMessages/LeaveHome',UPDATE_HOME_COUNT:'LitestandMessages/UpdateHomeCount',STORIES_INSERTED:'LitestandMessages/StoriesInserted',STORIES_REMOVED:'LitestandMessages/StoriesRemoved',NEWER_STORIES_INSERTED:'LitestandMessages/NewerStoriesInserted',EXPAND_FILTER_SWITCHER:'LitestandMessages/ExpandFilterSwitcher',RESTORE_FILTER_SWITCHER:'LitestandMessages/RestoreFilterSwitcher',NEW_STORY_BAR_CLICK:'LitestandMessages/NewStoryBarClick',COLLAPSE_FILTER_SWITCHER:'LitestandMessages/CollapseFilterSwitcher',TOUR_BEGIN:'LitestandMessages/TourBegin',TOUR_END:'LitestandMessages/TourEnd',TOUR_SIDEBAR_HIGHLIGHT:'LitestandMessages/TourSidebarHighlight',TOUR_SIDEBAR_UNHIGHLIGHT:'LitestandMessages/TourSidebarUnhighlight',RHC_RELOADED:'LitestandMessages/RHCReloaded',UNLOCK_FILTER_SWITCHER:'LitestandMessage/UnlockFilterSwitcher'};e.exports=g;});
__d("ScubaSample",["Banzai","copyProperties"],function(a,b,c,d,e,f){var g="scuba_sample",h=b("Banzai"),i=b("copyProperties");function j(m,n,o){this.fields={};this.flush=function(){if(!m)return;var p={};i(p,this.fields);p._ds=m;if(n)p._lid=n;p._options=o;h.post(g,p);this.flush=function(){};this.flushed=true;};this.lid=n;return this;}function k(m,n,o){if(!this.fields[m])this.fields[m]={};this.fields[m][n]=o;return this;}function l(m){return function(n,o){if(this.flushed)return this;return k.call(this,m,n,o);};}i(j.prototype,{addNormal:l('normal'),addInteger:l('int'),addDenorm:l('denorm')});e.exports=j;});
__d("ScriptMonitorReporter",["ScriptMonitor","ScubaSample","setTimeoutAcrossTransitions","URI"],function(a,b,c,d,e,f){var g=b('ScriptMonitor'),h=b('ScubaSample'),i=b('setTimeoutAcrossTransitions'),j=b('URI');function k(o){var p=[];for(var q=0;q<o.length;q++)p.push(new RegExp(o[q],'i'));return p;}function l(o,p){for(var q=0;q<p.length;q++)if(p[q].src)o.push(p[q].src);}function m(o,p){for(var q=0;q<p.length;q++)if(p[q].test(o))return true;return false;}function n(o,p){var q=g.stop(),r={addGeoFields:1,addBrowserFields:1,addUser:1},s={};l(q,document.getElementsByTagName('script'));l(q,document.getElementsByTagName('iframe'));for(var t=0;t<q.length;t++){var u=q[t].replace(/\?.*/,''),v;if(s[u])continue;s[u]=1;if(!j.isValidURI(u)){v=true;}else if(m(u,p)){v=false;}else if(m(new j(u).getDomain(),o)){v=false;}else v=true;if(v)new h('unknown_scripts',0,r).addNormal('url',u).flush();}}e.exports={runScan:function(o,p){i(function(){n(k(o),k(p));},5000);}};});
__d("MusicButtonStore",[],function(a,b,c,d,e,f){var g={},h={addButton:function(i,j){g[i]=j;return j;},getButton:function(i){return g[i];},getButtons:function(){return g;},removeButton:function(i){g[i]&&g[i].resetLoadingTimers();delete g[i];}};e.exports=h;});
__d("MusicConstants",["URI"],function(a,b,c,d,e,f){var g=b('URI'),h={DEBUG:false,LIVE_LISTEN_MIN_SPOTIFY_VERSION:'spotify-0.6.6.0.g5a9eaca5',enableDebug:function(){this.DEBUG=true;},sameURLs:function(i,j){var k=/\/$/;if(i&&j){i=g(i);j=g(j);return i.getDomain()==j.getDomain()&&i.getPath()==j.getPath();}return false;},greaterOrEqualToMinimumVersion:function(i,j){var k=/(?:\d+\.)+/,l=i.match(k)[0].split('.').slice(0,-1),m=j.match(k)[0].split('.').slice(0,-1);if(l.length!==m.length)return false;for(var n=0;n<m.length;n++)if(+l[n]<+m[n]){return false;}else if(+l[n]>+m[n])return true;return true;},sanitizeForProviders:function(i){var j={};for(var k in i)if(this.ALLOWED_EXTERNAL_CONTEXT_PARAMS[k])j[k]=i[k];return j;},OP:{RESUME:'RESUME',PAUSE:'PAUSE',PLAY:'PLAY',VERSION:'VERSION'},STATUS_CHANGE_OP:{STATUS:'STATUS',LOGIN:'LOGIN',REINFORM:'REINFORM'},STATUS_CHANGE_EVENT:{playing:'PLAY_STATE_CHANGED',track:'TRACK_CHANGED'},DIAGNOSTIC_EVENT:{ALL_PAUSED:'ALL_PAUSED',ALL_OFFLINE:'ALL_OFFLINE',OFFLINE:'OFFLINE',ONLINE:'ONLINE',SEARCHING:'SEARCHING',HIT:'HIT',MISS:'MISS',RESIGN:'RESIGN',IFRAME_POLLING:'IFRAME_POLLING',RELAUNCH:'RELAUNCH',STATE_CHANGE:'STATE_CHANGE',WRONG_VERSION:'WRONG_VERSION',SERVICE_ERROR:'SERVICE_ERROR',INCORRECT_ONLINE_STATE:'INCORRECT_ONLINE_STATE',LOG_SEND_OP:'LOG_SEND_OP',REQUEUE_OP:'REQUEUE_OP'},ALLOWED_STATUS_PARAMS:{playing:'playing',track:'track',context:'context',client_version:'client_version',start_time:'start_time',expires_in:'expires_in',open_graph_state:'open_graph_state'},ALLOWED_EXTERNAL_CONTEXT_PARAMS:{uri:true,song:true,radio_station:true,album:true,playlist:true,musician:true,song_list:true,offset:true,title:true,request_id:true,listen_with_friends:true,needs_tos:true},LIVE_LISTEN_OP:{NOW_LEADING:'NOW_LEADING',NOW_LISTENING:'NOW_LISTENING',END_SESSION:'END_SESSION',SONG_PLAYING:'SONG_PLAYING',LISTENER_UPDATE:'LISTENER_UPDATE',QUEUE_SESSION:'QUEUE_SESSION',PLAY_ERROR:'PLAY_ERROR',SESSION_UPDATED:'SESSION_UPDATED',QUEUING_SESSION:'QUEUING_SESSION'},MUSIC_BUTTON:{ACTIVATE:'ACTIVATE'},ERROR:{1:'SERVICE_UNAVAILABLE_WITHOUT_PREMIUM',2:'SERVICE_UNAVAILABLE_WITHOUT_PREMIUM_OR_WAIT',3:'SERVICE_UNAVAILABLE_BILLING_ISSUE',4:'SERVICE_UNAVAILABLE_TECHNICAL_ISSUE',5:'AUDIO_AD_PLAYING',99:'SERVICE_TEMPORARILY_UNAVAILABLE',101:'SONG_UNAVAILABLE_WITHOUT_PURCHASE',102:'SONG_UNAVAILABLE_WITHOUT_PREMIUM',103:'SONG_UNAVAILABLE_INDEFINITELY'}};e.exports=a.MusicConstants||h;});
__d("MusicEvents",["Arbiter"],function(a,b,c,d,e,f){var g=b('Arbiter');e.exports=a.MusicEvents=new g();});
__d("MusicButton",["BanzaiODS","Bootloader","copyProperties","CSS","DOM","MusicButtonStore","MusicConstants","MusicEvents","Parent","ScubaSample","Tooltip","cx"],function(a,b,c,d,e,f){var g=b('BanzaiODS'),h=b('Bootloader'),i=b('copyProperties'),j=b('CSS'),k=b('DOM'),l=b('MusicButtonStore'),m=b('MusicConstants'),n=b('MusicEvents'),o=b('Parent'),p=b('ScubaSample'),q=b('Tooltip'),r=b('cx'),s=function(t,u,v,w,x,y){this.provider=t;this.buttonElem=u;this.url=v;this.context=w||{};this.mediaType=x;this.setState(this.STATES.OFFLINE);this.tooltip=y||'';n.subscribe(m.MUSIC_BUTTON.ACTIVATE,this.processClick.bind(this));};i(s,{tracksetableTypes:[]});i(s.prototype,{SHOW_LOADING_TIMEOUT:500,HIDE_LOADING_TIMEOUT:4000,RECENTLY_ONLINE_TIMEOUT:6000,STATES:{PLAYING:'music_playing',PAUSED:'music_paused',LOADING:'music_loading',DISABLED:'music_disabled',OFFLINE:'music_offline'},setState:function(t){if(t!==this.STATES.LOADING){this.resetLoadingTimers();this.previousState=this.state||t;}if(t===this.STATES.PLAYING){q.set(this.buttonElem,this.tooltip);}else q.set(this.buttonElem,'');var u=this.buttonElem.parentNode;this.state&&j.removeClass(u,this.state);this.state=t;j.addClass(u,this.state);},isTracksetable:function(t){return s.tracksetableTypes.indexOf(this.mediaType)!==-1;},handleIncomingEvent:function(t,u){clearTimeout(this._showLoadingTimer);if(u&&u.provider&&u.provider!=this.provider)return;switch(t){case m.DIAGNOSTIC_EVENT.ONLINE:case m.STATUS_CHANGE_EVENT.track:case m.STATUS_CHANGE_EVENT.playing:var v=u&&u.track&&u.track.uri,w=u&&u.context&&u.context.uri;if(u&&u.playing&&(m.sameURLs(v,this.url)||m.sameURLs(w,this.url))){this.setState(this.STATES.PLAYING);}else if(this.state===this.STATES.LOADING&&(this.previousState===this.STATES.PAUSED||this.previousState===this.STATES.OFFLINE)){clearTimeout(this._attemptingPlayTimer);this._attemptingPlayTimer=this.setState.bind(this,this.STATES.PAUSED).defer(this.RECENTLY_ONLINE_TIMEOUT,false);}else if(!this._attemptingPlayTimer)this.setState(this.STATES.PAUSED);break;case m.DIAGNOSTIC_EVENT.OFFLINE:this.setState(this.STATES.OFFLINE);break;case m.DIAGNOSTIC_EVENT.ALL_OFFLINE:this.setState(this.STATES.OFFLINE);break;}},processClick:function(t,u){if(u!=this.buttonElem){if(this.state===this.STATES.LOADING)this.previousState&&this.setState(this.previousState);return;}var v=new p('music_play_button_click',null,{addBrowserFields:true,addGeoFields:true,addUser:true});v.addNormal('uses_bridge','1');v.addNormal('state',this.state);v.addNormal('provider',this.provider);v.addNormal('class','MusicButton');v.addDenorm('url',this.url);v.flush();if(this.state!=this.STATES.PLAYING){g.bumpEntityKey('music_play_button','music_play_button_click');g.bumpEntityKey('music_play_button','music_play_button_click.'+this.provider);var w=o.byClass(this.buttonElem,"_4--s");if(w){j.addClass(w,"_4--t");j.removeClass.curry(w,"_4--t").defer(3000);}}var x=this.isTracksetable()&&o.byClass(this.buttonElem,'music_trackset_container'),y=[];if(x){var z=x.getAttribute('data-trackset-title'),aa=this.provider,ba=k.scry(x,'.music_button');for(var ca=0;ca<ba.length;ca++){var da=l.getButton([ba[ca].id]);if(da&&da.provider==aa&&da.isTracksetable())y.push(da.url);}}if(!a.Music)this.showLoading(true);h.loadModules(['Music'],function(ea){var fa=(x&&y.length>1)?ea.playPauseSongList(this.provider,this.url,y,z,this.context):ea.playPauseSong(this.provider,this.url,this.context);this.showLoading(!fa);}.bind(this));},showLoading:function(t){this.resetLoadingTimers();this._hideLoadingTimer=this._timeout.bind(this,t).defer(this.HIDE_LOADING_TIMEOUT,false);this._showLoadingTimer=this.setState.bind(this,this.STATES.LOADING).defer(this.SHOW_LOADING_TIMEOUT,false);},resetLoadingTimers:function(){clearTimeout(this._hideLoadingTimer);clearTimeout(this._showLoadingTimer);clearTimeout(this._attemptingPlayTimer);this._attemptingPlayTimer=null;},destroy:function(){this.resetLoadingTimers();this.buttonElem=null;},_timeout:function(t){a.Music&&a.Music.reInform([this.provider]);if(!t&&this.state===this.STATES.LOADING)this.setState(this.STATES.PAUSED);}});e.exports=s;});
__d("MusicButtonManager",["Event","DOM","KeyedCallbackManager","Layer","MusicButton","MusicButtonStore","MusicConstants","MusicEvents","Parent","$","copyProperties","ge"],function(a,b,c,d,e,f){var g=b('Event'),h=b('DOM'),i=b('KeyedCallbackManager'),j=b('Layer'),k=b('MusicButton'),l=b('MusicButtonStore'),m=b('MusicConstants'),n=b('MusicEvents'),o=b('Parent'),p=b('$'),q=b('copyProperties'),r=b('ge'),s=new i(),t=null,u={},v=0;function w(da){var ea=da.getTarget(),fa=o.byClass(ea,'music_button');fa=fa||(!(da.getModifiers&&da.getModifiers().any)&&x(ea));if(!fa)return;return y(fa,da);}function x(da){var ea=o.byClass(da,'music_button_trigger')&&o.byClass(da,'music_button_trigger_group');if(ea){var fa=h.scry(ea,'.music_button');if(fa.length)return fa[0];}return null;}function y(da,event){event&&event.stop();n.inform(m.MUSIC_BUTTON.ACTIVATE,da);return false;}function z(da){a.Music&&a.Music.reInform(da);}function aa(da,ea){var fa=l.getButtons();for(var ga in fa)if(fa[ga].noGC||r(ga)){fa[ga].handleIncomingEvent(da,ea);}else l.removeButton(ga);}var ba={init:function(da){if(t)return;t=true;k.tracksetableTypes=da||[];g.listen(document.body,'click',w);n.subscribe([m.STATUS_CHANGE_EVENT.playing,m.STATUS_CHANGE_EVENT.track,m.DIAGNOSTIC_EVENT.OFFLINE,m.DIAGNOSTIC_EVENT.ALL_OFFLINE,m.DIAGNOSTIC_EVENT.ONLINE],aa);},add:function(da,ea,fa,ga,ha,ia){t||ba.init();var ja=ea.id,ka=l.getButton(ja);if(ka)return ka;ka=l.addButton(ja,new k(da,ea,fa,q({button_id:ja},ga),ha,ia));var la=o.byClass(ea,'uiOverlay');if(la){ka.noGC=true;var ma=j.subscribe('destroy',function(na,oa){if(h.contains(oa.getRoot(),ea)){l.removeButton(ja);j.unsubscribe(ma);}});}if(da&&!u[da])u[da]=function(){var na=Object.keys(u);na.length&&z(na);u={};}.defer();return ka;},addButton:function(da,ea,fa,ga,ha,ia){if(!r(ea))return;var ja=p(ea);return ba.add(da,ja,fa,ga,ha,ia);},asyncAddMusicButton:function(da,ea){da.setAttribute('id','music_button_'+v++);ca(da,ea);},tryAddButtonInDOM:function(da,ea){var fa=r(da);fa&&ca(fa,ea);},addMusicData:function(da,ea,fa,ga,ha,ia){s.setResource(da,{provider:ea,uri:fa,context:ga,media_type:ha,tooltip:ia});}};function ca(da,ea){var fa=h.find(da,'a.button_anchor').getAttribute('href');s.executeOrEnqueue(fa,function(ga){return ba.add(ga.provider,da,ga.uri,ga.context,ga.media_type,ea?ga.tooltip:'');});}e.exports=a.MusicButtonManager||ba;});