/*1373904942,173206321*/

if (self.CavalryLogger) { CavalryLogger.start_js(["m+DMw"]); }

__d("CSSAnimations",["function-extensions","CSS","cx"],function(a,b,c,d,e,f){b('function-extensions');var g=b('CSS'),h=b('cx'),i={bounce:function(j){g.addClass(j,"_3yk");g.removeClass.curry(j,"_3yk").defer(750);}};e.exports=i;});
__d("clamp",[],function(a,b,c,d,e,f){function g(h,i,j){return Math.max(h,Math.min(j,i));}e.exports=g;});
__d("ProfilePicRequestCreator",["copyProperties","Form"],function(a,b,c,d,e,f){var g=b('copyProperties'),h=b('Form');function i(j,k,l,m){this._fbid=j;this._owner=k;this._profileID=l;this._area=m;}g(i.prototype,{setSuccessURI:function(j){this._successURI=j;return this;},setErrorURI:function(j){this._errorURI=j;return this;},setIsUnscaled:function(j){this._isUnscaled=j;return this;},send:function(){var j=g({fbid:this._fbid,owner:this._owner,id:this._profileID,'return':this._successURI,error_return:this._errorURI,is_unscaled:this._isUnscaled},this._area);h.post('/crop_profile_pic.php',j);}});e.exports=i;});
__d("PhotocropConstraintConstants",[],function(a,b,c,d,e,f){var g={BOUNDARY:'boundary',SQUARE:'square',WIDE:'wide'};g.getAspectRatioForType=function(h){switch(h){case g.SQUARE:return 1;case g.WIDE:return 16/9;default:return null;}};e.exports=g;});
__d("PhotocropConstraint",["Vector","PhotocropConstraintConstants","clamp"],function(a,b,c,d,e,f){var g=b('Vector'),h=b('PhotocropConstraintConstants'),i=b('clamp');function j(p){this.photocrop=p;this.pos=null;}j.prototype.onMouseMove=function(p,q,r){var s=p.sub(this.pos);if(q){this.onResize(s,r);}else this.onMove(s);this.pos=this.pos.add(s);};j.prototype.onMouseDown=function(p){this.pos=p;};j.prototype.onResize=function(p,q){};j.prototype.onMove=function(p){var q=this.photocrop.box,r=this.photocrop.wrapper.offsetWidth,s=this.photocrop.wrapper.offsetHeight;p.x=i(-q.l,p.x,r-q.r);p.y=i(-q.t,p.y,s-q.b);this.photocrop.box=q.add(p);};for(var k in j)if(j.hasOwnProperty(k)&&k!=="_metaprototype")m[k]=j[k];var l=j===null?null:j.prototype;m.prototype=Object.create(l);m.prototype.constructor=m;m.__superConstructor__=j;function m(){if(j!==null)j.apply(this,arguments);}m.prototype.onResize=function(p,q){var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight;switch(q){case 'ne':t.r+=p.x=i(t.l+r-t.r,p.x,u-t.r);t.t+=p.y=i(-t.t,p.y,t.b-s-t.t);break;case 'nw':t.l+=p.x=i(-t.l,p.x,t.r-r-t.l);t.t+=p.y=i(-t.t,p.y,t.b-s-t.t);break;case 'se':t.r+=p.x=i(t.l+r-t.r,p.x,u-t.r);t.b+=p.y=i(t.t+s-t.b,p.y,v-t.b);break;case 'sw':t.l+=p.x=i(-t.l,p.x,t.r-r-t.l);t.b+=p.y=i(t.t+s-t.b,p.y,v-t.b);break;}};for(var k in j)if(j.hasOwnProperty(k)&&k!=="_metaprototype")n[k]=j[k];var l=j===null?null:j.prototype;n.prototype=Object.create(l);n.prototype.constructor=n;n.__superConstructor__=j;function n(){if(j!==null)j.apply(this,arguments);}n.prototype.setRatio=function(p){this.ratio=p;return this;};n.prototype.onMouseDown=function(p){l.onMouseDown.call(this,p);var q=this.photocrop.box,r=q.r-q.l,s=q.b-q.t;this.displacement=new g(r,s);};n.prototype.$AspectRatioConstraint0=function(p,q,r,s,t,u){var v,w,x,y,z;v=this.displacement.x/this.displacement.y;w=y=i(p,q,r);x=z=i(s,t,u);if(v>this.ratio){x=i(s,w/this.ratio,u);w=x*this.ratio;}else{w=i(p,x*this.ratio,r);x=w/this.ratio;}return new g(w,x);};n.prototype.onResize=function(p,q){var r=this.photocrop.min_width,s=this.photocrop.min_height,t=this.photocrop.box,u=this.photocrop.wrapper.offsetWidth,v=this.photocrop.wrapper.offsetHeight,w;switch(q){case 'ne':this.displacement=this.displacement.add(p.x,-p.y);w=this.$AspectRatioConstraint0(r,this.displacement.x,u-t.l,s,this.displacement.y,t.b);t.r=t.l+w.x;t.t=t.b-w.y;break;case 'nw':this.displacement=this.displacement.add(-p.x,-p.y);w=this.$AspectRatioConstraint0(r,this.displacement.x,t.r,s,this.displacement.y,t.b);t.l=t.r-w.x;t.t=t.b-w.y;break;case 'se':this.displacement=this.displacement.add(p.x,p.y);w=this.$AspectRatioConstraint0(r,this.displacement.x,u-t.l,s,this.displacement.y,v-t.t);t.r=t.l+w.x;t.b=t.t+w.y;break;case 'sw':this.displacement=this.displacement.add(-p.x,p.y);w=this.$AspectRatioConstraint0(r,this.displacement.x,t.r,s,this.displacement.y,v-t.t);t.l=t.r-w.x;t.b=t.t+w.y;break;}};function o(p,q){var r;switch(q){case h.BOUNDARY:r=new m(p);break;case h.WIDE:case h.SQUARE:r=new n(p).setRatio(h.getAspectRatioForType(q));break;default:throw Error('unsupported PhotocropConstraint type');}return r;}e.exports=o;});
__d("Photocrop2",["Event","ArbiterMixin","CSS","DOM","PhotosConst","PhotocropConstraintConstants","PhotocropConstraint","Vector","Rect","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('ArbiterMixin'),i=b('CSS'),j=b('DOM'),k=b('PhotosConst'),l=b('PhotocropConstraintConstants'),m=b('PhotocropConstraint'),n=b('Vector'),o=b('Rect'),p=b('copyProperties');function q(r,s,t){this.photo=r;var u=this.getPhotoDimensions();if(t){this.imageDimensions=new n(t.x,t.y);}else this.imageDimensions=new n(u.x,u.y);p(this,p({target:this.photo.parentNode,create_target:false,target_parent:this.photo.parentNode,width:200,height:200,min_width:k.PIC_NORMAL_FBX_SIZE,min_height:k.PIC_NORMAL_FBX_SIZE,center_x:(u.x||200)/2,center_y:(u.y||200)/2,constraint_type:l.BOUNDARY},s));this.initialMinWidth=this.min_width;this.initialMinHeight=this.min_height;this.setInitialDimensionsAndPos();if(this.create_target){this.target=j.create('div');i.addClass(this.target,'stageCropper');this.target_parent.appendChild(this.target);}i.addClass(this.target,'photocrop');['bg','wrapper','viewport'].forEach(function(v){this[v]=j.create('div');i.addClass(this[v],v);}.bind(this));this.highlight=j.create('img');i.addClass(this.highlight,'highlight');this.setHighlightSource();i.addClass(this.wrapper,'photocropWrapper');this.target.appendChild(this.bg);this.target.appendChild(this.wrapper);this.wrapper.appendChild(this.highlight);this.wrapper.appendChild(this.viewport);['ne','nw','sw','se'].forEach(function(v){var w=j.create('div');i.addClass(w,v);w.setAttribute('data-cropcorner',v);this.viewport.appendChild(w);i.addClass(w,'profilePicViewportGrabby');}.bind(this));g.listen(this.viewport,{mousedown:this.mousedown.bind(this),dragstart:g.kill,selectstart:g.kill,click:g.stop});g.listen(document,{mousemove:this.mousemove.bind(this),mouseup:this.mouseup.bind(this)});g.listen(window,{resize:this.adjustForResize.bind(this)});this.realignToPictureSize();this.redraw();}p(q.prototype,h);q.prototype.setInitialDimensionsAndPos=function(){this._constraint=m(this,this.constraint_type);var r=l.getAspectRatioForType(this.constraint_type),s=this.getPhotoDimensions();this.unscaledMinWidth=this.min_width;this.unscaledMinHeight=this.min_height;if(r!==null){this.unscaledMinWidth=this.min_width;this.unscaledMinHeight=this.unscaledMinWidth/r;}this.setNewRatio();var t=Math.min(this.width,s.x),u=Math.min(this.height,s.y);this.min_width=Math.min(this.min_width,s.x);this.min_height=Math.min(this.min_height,s.y);if(r!==null)if(s.x/s.y>r){u=Math.min(u,s.y);t=u*r;this.min_width=this.min_height*r;}else{t=Math.min(t,s.x);u=t/r;this.min_height=this.min_width/r;}var v=this.center_x-t/2,w=this.center_y-u/2;this.box=new o(w,v+t,w+u,v);};q.prototype.getPhotoDimensions=function(){return n.getElementDimensions(this.photo);};q.prototype.getPhotoPosition=function(){return new n(this.photo.offsetLeft,this.photo.offsetTop);};q.prototype.setHighlightSource=function(){this.highlight.src=this.photo.src;};q.prototype.setConstraintType=function(r){this.constraint_type=r;this.min_width=this.initialMinWidth;this.min_height=this.initialMinHeight;this.setInitialDimensionsAndPos();this.adjustForResize();};q.prototype.adjustForResize=function(){var r=this.ratio,s=this.setNewRatio(),t=s/r;this.box.t*=t;this.box.l*=t;this.box.b*=t;this.box.r*=t;this.redraw();this.realignToPictureSize();};q.prototype.setNewRatio=function(){this.ratio=this.getPhotoDimensions().x/this.imageDimensions.x;this.min_width=this.ratio*this.unscaledMinWidth;this.min_height=this.ratio*this.unscaledMinHeight;return this.ratio;};q.prototype.realignToPictureSize=function(){var r=this.photo;if(!r)return;var s=this.getPhotoDimensions(),t=this.getPhotoPosition();[this.bg,this.wrapper].forEach(function(u){u.style.width=s.x+'px';u.style.height=s.y+'px';u.style.top=t.y+'px';u.style.left=t.x+'px';});};q.prototype.redraw=function(){var r=[this.box.t,this.box.r,this.box.b,this.box.l],s=this.getPhotoDimensions();this.highlight.style.width=s.x+"px";this.highlight.style.height=s.y+"px";this.highlight.style.clip="rect("+r.join("px ")+"px)";this.viewport.style.top=this.box.t+"px";this.viewport.style.left=this.box.l+"px";this.viewport.style.height=(this.box.b-this.box.t)+"px";this.viewport.style.width=(this.box.r-this.box.l)+"px";};q.prototype.done=function(r){this.freezeViewport=true;if(!r){[this.bg,this.wrapper].forEach(j.remove);if(this.create_target){j.remove(this.target);this.target=null;}else i.removeClass(this.target,'photocrop');}var s=Math.round(this.box.l*(1/this.ratio)),t=Math.round(this.box.t*(1/this.ratio)),u=Math.round(this.box.r*(1/this.ratio)),v=Math.round(this.box.b*(1/this.ratio));this.inform('done',r);return {x:Math.max(s,0),y:Math.max(t,0),width:u-Math.max(s,0),height:v-Math.max(t,0)};};q.prototype.mousedown=function(r){if(this.freezeViewport)return;this.mouseTarget=r.getTarget();this._constraint.onMouseDown(n.getEventPosition(r));i.addClass(document.body,'draggingMode');return false;};q.prototype.mousemove=function(r){if(!this.mouseTarget)return;this._constraint.onMouseMove(n.getEventPosition(r),this.mouseTarget!==this.viewport,this.mouseTarget.getAttribute('data-cropcorner'));this.redraw();return false;};q.prototype.mouseup=function(r){this.mouseTarget=null;i.removeClass(document.body,'draggingMode');};e.exports=q;});
__d("BlobFactory",["emptyFunction"],function(a,b,c,d,e,f){var g=b('emptyFunction'),h,i=a.BlobBuilder||a.WebKitBlobBuilder||a.MozBlobBuilder||a.MSBlobBuilder;if(a.Blob){var j;try{new a.Blob();j=true;}catch(k){j=false;}h={getBlob:function(l,m){l=l||[];m=m||{};if(j){return new a.Blob(l,m);}else{var n=new i();for(var o=0;o<l.length;o++)n.append(l[o]);return n.getBlob(m.type);}},isSupported:g.thatReturnsTrue};}else h={getBlob:function(){},isSupported:g.thatReturnsFalse};e.exports=h;});