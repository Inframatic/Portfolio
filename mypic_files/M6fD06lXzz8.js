/*!CK:1986381624!*//*1375796940,173214301*/

if (self.CavalryLogger) { CavalryLogger.start_js(["rR+QI"]); }

__d("HubsTypeaheadView",["Arbiter","AsyncRequest","ContextualTypeaheadView","CSS","DOM","Event","$","copyProperties","tx"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('AsyncRequest'),i=b('ContextualTypeaheadView'),j=b('CSS'),k=b('DOM'),l=b('Event'),m=b('$'),n=b('copyProperties'),o=b('tx');for(var p in i)if(i.hasOwnProperty(p)&&p!=="_metaprototype")r[p]=i[p];var q=i===null?null:i.prototype;r.prototype=Object.create(q);r.prototype.constructor=r;r.__superConstructor__=i;function r(s,t){i.call(this,s,t);if(t.allowDedupe)this.subscribe('select',this.selectDuplicates.bind(this));}r.prototype.hide=function(){return this.canHide?q.hide.call(this):null;};r.prototype.reset=function(){return this.canHide?q.reset.call(this):null;};r.prototype._createFreeFormNode=function(s){return {text:this.showCreatePrompt?o._("Add \"{partial_name}\"",{partial_name:s}):s,orig_text:s,type:'addnew calltoaction'};};r.prototype.render=function(s,t,u){if(this.allowClientRanking){var v=[],w=Math.max(1,Math.floor(t.length/10));for(var x=w;x<t.length;x++)if(!!t[x].already_added){v.push(t[x]);t.splice(x,1);x--;}t=t.concat(v);}if(this.alwaysRender&&s!=='')if(this.allowFreeformEntry){t.push(this._createFreeFormNode(s));}else{var y=s.toLowerCase().trim(),z=false;for(var aa=0;aa<t.length;aa++)if(y==t[aa].text.toLowerCase().trim()){z=true;break;}if(!z)t.push(this._createFreeFormNode(s));}var ba=t.length;for(var ca=0;ca<t.length;ca++)if(!t[ca].uid)ba--;if(this.allowDedupe&&ba>1)t.push({text:"Mark Duplicate Results",type:'dupelink calltoaction'});return q.render.call(this,s,t,u);};r.prototype.selectDuplicates=function(s,t){if(!t.selected.type.match('dupelink'))return;var u=[];for(var v=0;v<this.results.length;v++){if(!this.results[v].uid)continue;u.push(this.results[v].uid);}var w=g.subscribe('typeahead/'+this.collectionID+'/confirmDupes',function(x,y){var z=this.results.map(function(ca){return ca.uid;});for(var aa=0;aa<y.dupe_ids.length;aa++){var ba=z.indexOf(y.dupe_ids[aa]);j.hide(this.items[ba]);}this.hasHiddenDupes=y.dupe_ids.length>0;}.bind(this));g.subscribe('typeahead/'+this.collectionID+'/finishDupes',function(x,y){g.unsubscribe(w);this.canHide=true;this.hasHiddenDupes&&j.hide(k.find(this.content,'.dupelink'));this.hasHiddenDupes=false;}.bind(this));this.canHide=false;new h('/ajax/typeahead/quality/duplicates').setData({ids:u,surface:m('collections_surface').value,collection_id:this.collectionID}).send();};r.initFreeformBoxes=function(){var s=k.scry(document,'div.fbAddFormDialog')[0];if(!s)return;var t=k.find(s,'form');l.listen(t,'submit',function(){k.scry(t,'div.fbFreeformInput').forEach(function(u){if(k.find(u,'input.inputtext').value)j.addClass(u.firstChild,'selected');});});};n(r.prototype,{canHide:true,hasHiddenDupes:false});e.exports=r;});
__d("BanzaiNectarSimple",["Banzai"],function(a,b,c,d,e,f){var g=b('Banzai');function h(j){return {log:function(k,l,m){var n={e:l,a:m};g.post('nectar_simple:'+k,n,j);}};}var i=h();i.create=h;e.exports=i;});
__d("ProfileQuestionsForm",["BanzaiNectarSimple","CSS","DOM","Form","cx","csx","tidyEvent"],function(a,b,c,d,e,f){var g=b('BanzaiNectarSimple'),h=b('CSS'),i=b('DOM'),j=b('Form'),k=b('cx'),l=b('csx'),m=b('tidyEvent'),n={POPULATED:"_5daa"},o={FOOTER:"._59q7"},p=false;function q(r,s,t,u,v){this.$ProfileQuestionsForm0=r;this.$ProfileQuestionsForm1=s;this.$ProfileQuestionsForm2=t;this.$ProfileQuestionsForm3=u.logData||{};this.$ProfileQuestionsForm4=u.shouldAutosave;this.$ProfileQuestionsForm5=i.find(this.$ProfileQuestionsForm0,'input[name="action"]');this.$ProfileQuestionsForm6=v?v:i.find(this.$ProfileQuestionsForm0,o.FOOTER);m([this.$ProfileQuestionsForm1.subscribe('populated',this.$ProfileQuestionsForm7.bind(this))]);}q.prototype.$ProfileQuestionsForm8=function(){if(p)return;g.log('socrates_impressions','question_interact',this.$ProfileQuestionsForm3);p=true;};q.prototype.$ProfileQuestionsForm7=function(event,r){r&&this.$ProfileQuestionsForm8();if(this.$ProfileQuestionsForm4){this.$ProfileQuestionsForm9('save');this.$ProfileQuestionsForma();return;}h.conditionClass(this.$ProfileQuestionsForm6,n.POPULATED,r);};q.prototype.$ProfileQuestionsForma=function(){i.appendContent(this.$ProfileQuestionsForm0,this.$ProfileQuestionsForm2);j.bootstrap(this.$ProfileQuestionsForm0);};q.prototype.$ProfileQuestionsForm9=function(r){this.$ProfileQuestionsForm5.value=r;};e.exports=q;});
__d("ProfileQuestionFormatSinglePage",["ArbiterMixin","CSS","DOM","Event","Parent","cx","mixin","tidyEvent"],function(a,b,c,d,e,f){var g=b('ArbiterMixin'),h=b('CSS'),i=b('DOM'),j=b('Event'),k=b('Parent'),l=b('cx'),m=b('mixin'),n=b('tidyEvent'),o={ITEM:"_5ds4",ITEM_SELECTED:"_5ds5"},p=m(g);for(var q in p)if(p.hasOwnProperty(q)&&q!=="_metaprototype")s[q]=p[q];var r=p===null?null:p.prototype;s.prototype=Object.create(r);s.prototype.constructor=s;s.__superConstructor__=p;function s(t,u,v,w){this.$ProfileQuestionFormatSinglePage0=t;this.$ProfileQuestionFormatSinglePage1=u;this.$ProfileQuestionFormatSinglePage2=v;this.$ProfileQuestionFormatSinglePage3=w;this.$ProfileQuestionFormatSinglePage4=i.find(this.$ProfileQuestionFormatSinglePage2,'input[name="page_id"]');n([j.listen(this.$ProfileQuestionFormatSinglePage2,'click',this.$ProfileQuestionFormatSinglePage5.bind(this)),this.$ProfileQuestionFormatSinglePage3.subscribe('select',this.$ProfileQuestionFormatSinglePage6.bind(this)),this.$ProfileQuestionFormatSinglePage3.subscribe('unselect',this.$ProfileQuestionFormatSinglePage7.bind(this,null))]);}s.prototype.$ProfileQuestionFormatSinglePage6=function(t,u){var v=(u&&u.selected);v&&v.uid&&this.$ProfileQuestionFormatSinglePage7(parseInt(v.uid,10));};s.prototype.$ProfileQuestionFormatSinglePage5=function(event){var t=k.byClass(event.getTarget(),o.ITEM);if(!t)return;var u=this.$ProfileQuestionFormatSinglePage1[t.id];if(this.$ProfileQuestionFormatSinglePage4.value==u)u=null;if(this.$ProfileQuestionFormatSinglePage3.getCore().getHiddenValue())this.$ProfileQuestionFormatSinglePage3.getCore().reset();this.$ProfileQuestionFormatSinglePage7(u);};s.prototype.$ProfileQuestionFormatSinglePage7=function(t){this.$ProfileQuestionFormatSinglePage4.value=t;for(var u=0;u<this.$ProfileQuestionFormatSinglePage0.length;u++){var v=this.$ProfileQuestionFormatSinglePage0[u];this.$ProfileQuestionFormatSinglePage9(v,this.$ProfileQuestionFormatSinglePage1[v.id]==t);}this.inform('populated',!!t);};s.prototype.$ProfileQuestionFormatSinglePage9=function(t,u){h.conditionClass(t,o.ITEM_SELECTED,u);};e.exports=s;});
__d("TimelineAboutUnitAddCityDialog",["Arbiter","Button","CSS","DOM","DOMEventListener"],function(a,b,c,d,e,f){var g=b('Arbiter'),h=b('Button'),i=b('CSS'),j=b('DOM'),k=b('DOMEventListener'),l=b('DOM');function m(n,o,p,q){this.dialog=o;var r=o.getRoot();this.icon=n;this._typeahead=p;this._radioCities=l.scry(r,'input[type="radio"]');this._textOther=j.find(r,'.textOther');this._buttonSave=l.scry(r,'button[name="save"]')[0];if(this._radioCities.length>0){this._radioCityOther=j.find(r,'.radioCityOther');this._typeahead.subscribe('select',this._enableSaveButtonTypeahead.bind(this));this._typeahead.subscribe('unselect',this._disableSaveButtonTypeahead.bind(this));for(var s=0;s<this._radioCities.length-1;s++)k.add(this._radioCities[s],'click',this._enableSaveButton.bind(this));k.add(this._radioCityOther,'click',this._saveButtonCityOther.bind(this));}else{this._typeahead.subscribe('select',this._enableSaveButton.bind(this));this._typeahead.subscribe('unselect',this._disableSaveButton.bind(this));}k.add(this.icon,'click',function(t){t.prevent();o.show();});if(this._radioCityOther){k.add(this._textOther,'focus',this._selectRadioOther.bind(this));k.add(this._radioCityOther,'click',this._focusTextOther.bind(this));}if(q)o.show();g.subscribe(m.SUBMIT,this.submitted.bind(this));}m.prototype.submitted=function(){var n=false;if(this._radioCities.length===0){if(this._typeahead.getCore().getHiddenValue()!=='')n=true;}else{for(var o=0;o<this._radioCities.length-1;o++)if(this._radioCities[o].checked){n=true;break;}if(this._radioCityOther.checked)if(this._typeahead.getCore().getHiddenValue()!==''){n=true;}else n=false;}if(n)i.hide(this.icon);};m.prototype._focusTextOther=function(){this._textOther.focus();};m.prototype._selectRadioOther=function(){this._radioCityOther.checked=true;if(this._typeahead.getCore().getHiddenValue()!==''){h.setEnabled(this._buttonSave,true);}else h.setEnabled(this._buttonSave,false);};m.prototype._enableSaveButton=function(){h.setEnabled(this._buttonSave,true);};m.prototype._disableSaveButton=function(){h.setEnabled(this._buttonSave,false);};m.prototype._enableSaveButtonTypeahead=function(){if(this._radioCityOther.checked)h.setEnabled(this._buttonSave,true);};m.prototype._disableSaveButtonTypeahead=function(){if(this._radioCityOther.checked)h.setEnabled(this._buttonSave,false);};m.prototype._saveButtonCityOther=function(){if(this._typeahead.getCore().getHiddenValue()!==''){h.setEnabled(this._buttonSave,true);}else h.setEnabled(this._buttonSave,false);};m.SUBMIT='AddSchoolCitySubmitted';e.exports=m;});
__d("legacy:PreventSubmitOnEnterTypeaheadBehavior",["TypeaheadPreventSubmitOnEnter"],function(a,b,c,d){var e=b('TypeaheadPreventSubmitOnEnter');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.preventSubmitOnEnter=function(f){f.enableBehavior(e);};},3);
__d("TypeaheadRequireSelection",["Event","copyProperties"],function(a,b,c,d,e,f){var g=b('Event'),h=b('copyProperties');function i(j){this._typeahead=j;}i.prototype.enable=function(){var j=this._typeahead.getCore(),k=j.getElement().form;function l(){!j.getHiddenValue()&&j.reset();}l();this._subscription=j.subscribe('blur',l);if(k)this._eventListener=g.listen(k,'submit',l);};i.prototype.disable=function(){this._typeahead.getCore().unsubscribe(this._subscription);this._subscription=null;if(this._eventListener){this._eventListener.remove();this._eventListener=null;}};h(i.prototype,{_subscription:null,_eventListener:null});e.exports=i;});
__d("legacy:RequireSelectionTypeaheadBehavior",["TypeaheadRequireSelection"],function(a,b,c,d){var e=b('TypeaheadRequireSelection');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.requireSelection=function(f){f.enableBehavior(e);};},3);
__d("TypeaheadSetPhotoOnSelect",["function-extensions","CSS","DOM","Event","copyProperties"],function(a,b,c,d,e,f){b('function-extensions');var g=b('CSS'),h=b('DOM'),i=b('Event'),j=b('copyProperties');function k(l){this._typeahead=l;}k.prototype.enable=function(){var l=h.scry(this._typeahead.getElement(),'.photo')[0];if(l){if(!h.isNodeOfType(l,'img')){var m=h.create('img',{className:l.className});h.replace(l,m);l=m;}var n=g.hide.curry(l),o=g.show.curry(l);this._eventListener=i.listen(l,{load:o,error:n,abort:n});this._subscription=this._typeahead.subscribe('select',function(p,q){var r=q.selected.photo||this._typeahead.view.fallbackPhoto;r?l.setAttribute('src',r):n();}.bind(this));}};k.prototype.disable=function(){this._eventListener.remove();this._eventListener=null;this._typeahead.unsubscribe(this._subscription);this._subscription=null;};j(k.prototype,{_eventListener:null,_subscription:null});e.exports=k;});
__d("legacy:SetPhotoOnSelectTypeaheadBehavior",["TypeaheadSetPhotoOnSelect"],function(a,b,c,d){var e=b('TypeaheadSetPhotoOnSelect');if(!a.TypeaheadBehaviors)a.TypeaheadBehaviors={};a.TypeaheadBehaviors.setPhotoOnSelect=function(f){f.enableBehavior(e);};},3);